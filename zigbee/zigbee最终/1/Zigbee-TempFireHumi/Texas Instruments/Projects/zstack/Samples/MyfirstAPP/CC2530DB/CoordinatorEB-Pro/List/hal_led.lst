###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         19/Jun/2019  14:08:52 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Users\fangxi1998\Desktop\课程设计\zigbee        #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Components\hal\target\CC2530EB\hal_le #
#                          d.c                                                #
#    Command line       =  -f "C:\Users\fangxi1998\Desktop\课程设计\zigbee    #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\Tools\CC2530DB\f8wCoord.cfg"       #
#                          (-DCPU32MHZ -DROOT=__near_func                     #
#                          -DMAC_CFG_APP_PENDING_QUEUE=TRUE                   #
#                          -DZDO_COORDINATOR -DRTR_NWK -DBLINK_LEDS) -f       #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\Tools\CC2530DB\f8wConfig.cfg"      #
#                          (-DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR      #
#                          -DDEFAULT_CHANLIST=0x04000000                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xA1B2                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Components\hal\target\CC2530EB\hal_le #
#                          d.c" -D ZIGBEEPRO -D ZTOOL_P1 -D MT_TASK -D        #
#                          MT_SYS_FUNC -D MT_ZDO_FUNC -D LCD_SUPPORTED=DEBUG  #
#                          -D DH_AD_KEY_DEVICE -lC "C:\Users\fangxi1998\Deskt #
#                          op\课程设计\zigbee 嵌入式linux\zigbee最终\1\Zigbee #
#                          -TempFireHumi\Texas Instruments\Projects\zstack\Sa #
#                          mples\MyfirstAPP\CC2530DB\CoordinatorEB-Pro\List\" #
#                           -lA "C:\Users\fangxi1998\Desktop\课程设计\zigbee  #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\CoordinatorEB-Pro\List\" --diag_suppress    #
#                          Pe001,Pa010 -o "C:\Users\fangxi1998\Desktop\课程设 #
#                          计\zigbee 嵌入式linux\zigbee最终\1\Zigbee-TempFire #
#                          Humi\Texas Instruments\Projects\zstack\Samples\Myf #
#                          irstAPP\CC2530DB\CoordinatorEB-Pro\Obj\" -e        #
#                          --debug --core=plain --dptr=16,1                   #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 8 -I  #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\" -I "C:\Users\fangxi1998\Desktop\课程设计\ #
#                          zigbee 嵌入式linux\zigbee最终\1\Zigbee-TempFireHum #
#                          i\Texas Instruments\Projects\zstack\Samples\Myfirs #
#                          tAPP\CC2530DB\..\SOURCE\" -I                       #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\ZMAIN\TI2530DB\" -I                #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\MT\" -I           #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\HAL\INCLUDE\" -I  #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\HAL\TARGET\CC2530 #
#                          EB\" -I "C:\Users\fangxi1998\Desktop\课程设计\zigb #
#                          ee 嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Te #
#                          xas Instruments\Projects\zstack\Samples\MyfirstAPP #
#                          \CC2530DB\..\..\..\..\..\COMPONENTS\OSAL\MCU\CCSOC #
#                          \" -I "C:\Users\fangxi1998\Desktop\课程设计\zigbee #
#                           嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texa #
#                          s Instruments\Projects\zstack\Samples\MyfirstAPP\C #
#                          C2530DB\..\..\..\..\..\COMPONENTS\OSAL\INCLUDE\"   #
#                          -I "C:\Users\fangxi1998\Desktop\课程设计\zigbee    #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\STACK\AF\" -I     #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\STACK\NWK\" -I    #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\STACK\SEC\" -I    #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\STACK\SAPI\" -I   #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\STACK\SYS\" -I    #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\STACK\ZDO\" -I    #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\ZMAC\F8W\" -I     #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\ZMAC\" -I         #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\SERVICES\SADDR\"  #
#                          -I "C:\Users\fangxi1998\Desktop\课程设计\zigbee    #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\SERVICES\SDATA\"  #
#                          -I "C:\Users\fangxi1998\Desktop\课程设计\zigbee    #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\MAC\INCLUDE\" -I  #
#                          "C:\Users\fangxi1998\Desktop\课程设计\zigbee       #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\MAC\HIGH_LEVEL\"  #
#                          -I "C:\Users\fangxi1998\Desktop\课程设计\zigbee    #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\..\..\..\..\..\COMPONENTS\MAC\LOW_LEVEL\srf #
#                          04\" -I "C:\Users\fangxi1998\Desktop\课程设计\zigb #
#                          ee 嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Te #
#                          xas Instruments\Projects\zstack\Samples\MyfirstAPP #
#                          \CC2530DB\..\..\..\..\..\COMPONENTS\MAC\LOW_LEVEL\ #
#                          srf04\SINGLE_CHIP\" -Ohz --require_prototypes      #
#    List file          =  C:\Users\fangxi1998\Desktop\课程设计\zigbee        #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\CoordinatorEB-Pro\List\hal_led.lst          #
#    Object file        =  C:\Users\fangxi1998\Desktop\课程设计\zigbee        #
#                          嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas #
#                           Instruments\Projects\zstack\Samples\MyfirstAPP\CC #
#                          2530DB\CoordinatorEB-Pro\Obj\hal_led.r51           #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\fangxi1998\Desktop\课程设计\zigbee 嵌入式linux\zigbee最终\1\Zigbee-TempFireHumi\Texas Instruments\Components\hal\target\CC2530EB\hal_led.c
      1          /**************************************************************************************************
      2            Filename:       hal_led.c
      3            Revised:        $Date: 2009-03-13 05:45:44 -0700 (Fri, 13 Mar 2009) $
      4            Revision:       $Revision: 19408 $
      5          
      6            Description:    This file contains the interface to the HAL LED Service.
      7          
      8          
      9            Copyright 2006-2007 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /***************************************************************************************************
     41           *                                             INCLUDES
     42           ***************************************************************************************************/
     43          #include "hal_mcu.h"

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
     44          #include "hal_defs.h"
     45          #include "hal_types.h"
     46          #include "hal_drivers.h"
     47          #include "hal_led.h"
     48          #include "osal.h"
     49          #include "hal_board.h"
     50          
     51          /***************************************************************************************************
     52           *                                             CONSTANTS
     53           ***************************************************************************************************/
     54          
     55          /***************************************************************************************************
     56           *                                              MACROS
     57           ***************************************************************************************************/
     58          
     59          /***************************************************************************************************
     60           *                                              TYPEDEFS
     61           ***************************************************************************************************/
     62          /* LED control structure */
     63          typedef struct {
     64            uint8 mode;       /* Operation mode */
     65            uint8 todo;       /* Blink cycles left */
     66            uint8 onPct;      /* On cycle percentage */
     67            uint16 time;      /* On/off cycle time (msec) */
     68            uint32 next;      /* Time for next change */
     69          } HalLedControl_t;
     70          
     71          typedef struct
     72          {
     73            HalLedControl_t HalLedControlTable[HAL_LED_DEFAULT_MAX_LEDS];
     74            uint8           sleepActive;
     75          } HalLedStatus_t;
     76          
     77          
     78          /***************************************************************************************************
     79           *                                           GLOBAL VARIABLES
     80           ***************************************************************************************************/
     81          
     82          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     83          static uint8 HalLedState;              // LED state at last set/clr/blink update
   \                     HalLedState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     84          
     85          #if HAL_LED == TRUE

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     86          static uint8 HalSleepLedState;         // LED state at last set/clr/blink update
   \                     HalSleepLedState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     87          static uint8 preBlinkState;            // Original State before going to blink mode
   \                     preBlinkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     88                                                 // bit 0, 1, 2, 3 represent led 0, 1, 2, 3
     89          #endif
     90          
     91          #ifdef BLINK_LEDS

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     92            static HalLedStatus_t HalLedStatusControl;
   \                     HalLedStatusControl:
   \   000000                DS 37
   \   000025                REQUIRE __INIT_XDATA_Z
     93          #endif
     94          
     95          /***************************************************************************************************
     96           *                                            LOCAL FUNCTION
     97           ***************************************************************************************************/
     98          #if (HAL_LED == TRUE)
     99          void HalLedUpdate (void);
    100          void HalLedOnOff (uint8 leds, uint8 mode);
    101          #endif /* HAL_LED */
    102          
    103          /***************************************************************************************************
    104           *                                            FUNCTIONS - API
    105           ***************************************************************************************************/
    106          
    107          /***************************************************************************************************
    108           * @fn      HalLedInit
    109           *
    110           * @brief   Initialize LED Service
    111           *
    112           * @param   init - pointer to void that contains the initialized value
    113           *
    114           * @return  None
    115           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    116          void HalLedInit (void)
   \                     HalLedInit:
    117          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    118             P1DIR |= 0x0f;//自己添加
   \   000004   43FE0F       ORL     0xfe,#0xf
    119          #if (HAL_LED == TRUE)
    120            /* Initialize all LEDs to OFF */
    121            HalLedSet (HAL_LED_ALL, HAL_LED_MODE_OFF);
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007   7A00         MOV     R2,#0x0
   \   000009   790F         MOV     R1,#0xf
   \   00000B   12....       LCALL   ??HalLedSet?relay
    122          #endif /* HAL_LED */
    123          #ifdef BLINK_LEDS
    124            /* Initialize sleepActive to FALSE */
    125            HalLedStatusControl.sleepActive = FALSE;
   \   00000E   02....       LJMP    ?Subroutine0 & 0xFFFF
   \   000011                REQUIRE P1DIR
    126          #endif
    127           
    128          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   90....       MOV     DPTR,#HalLedStatusControl + 36
   \   000003   E4           CLR     A
   \   000004                REQUIRE ??Subroutine8_0
   \   000004                ; // Fall through to label ??Subroutine8_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine8_0:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                REQUIRE ??Subroutine9_0
   \   000001                ; // Fall through to label ??Subroutine9_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine9_0:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    129          
    130          /***************************************************************************************************
    131           * @fn      HalLedSet
    132           *
    133           * @brief   Tun ON/OFF/TOGGLE given LEDs
    134           *
    135           * @param   led - bit mask value of leds to be turned ON/OFF/TOGGLE
    136           *          mode - BLINK, FLASH, TOGGLE, ON, OFF
    137           * @return  None
    138           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    139          uint8 HalLedSet (uint8 leds, uint8 mode)
   \                     HalLedSet:
    140          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 0,R1
   \   000007   8A..         MOV     ?V0 + 1,R2
    141          
    142          #if (defined (BLINK_LEDS)) && (HAL_LED == TRUE)
    143            uint8 led;
    144            HalLedControl_t *sts;
    145            switch (mode)
   \   000009   EA           MOV     A,R2
   \   00000A   602F         JZ      ??HalLedSet_0
   \   00000C   14           DEC     A
   \   00000D   602C         JZ      ??HalLedSet_0
   \   00000F   14           DEC     A
   \   000010   600A         JZ      ??HalLedSet_1
   \   000012   24FE         ADD     A,#-0x2
   \   000014   601B         JZ      ??HalLedSet_2
   \   000016   24FC         ADD     A,#-0x4
   \   000018   6021         JZ      ??HalLedSet_0
   \   00001A   800B         SJMP    ??HalLedSet_3
    146            {
    147              case HAL_LED_MODE_BLINK:
    148                // Default blink, 1 time, D% duty cycle 
    149                HalLedBlink (leds, 1, HAL_LED_DEFAULT_DUTY_CYCLE, HAL_LED_DEFAULT_FLASH_TIME);
   \                     ??HalLedSet_1:
   \   00001C                ; Setup parameters for call to function HalLedBlink
   \   00001C   7CE8         MOV     R4,#-0x18
   \   00001E   7D03         MOV     R5,#0x3
   \   000020   7B05         MOV     R3,#0x5
   \   000022   7A01         MOV     R2,#0x1
   \                     ??HalLedSet_4:
   \   000024   12....       LCALL   ??HalLedBlink?relay
    150                break;
    151          
    152              case HAL_LED_MODE_FLASH:
    153                // Default flash, N times, D% duty cycle 
    154                HalLedBlink (leds, HAL_LED_DEFAULT_FLASH_COUNT, HAL_LED_DEFAULT_DUTY_CYCLE, HAL_LED_DEFAULT_FLASH_TIME);
    155                break;
    156          
    157              case HAL_LED_MODE_ON:
    158                /****************
    159                自己添加的程序
    160                ****************/
    161               /* if (leds & HAL_LED_1)
    162                {
    163                  P1DIR |= 0x01;
    164                  P1_0 = 0;
    165                    break;
    166                }
    167                  if (leds & HAL_LED_2)
    168                {
    169                  P1DIR |= 0x02;
    170                    P1_1 = 0;
    171                    break;
    172                }
    173                  if (leds & HAL_LED_3)
    174                {
    175                  P1DIR |= 0x03;
    176                    P1_2 = 0;
    177                    break;
    178                }
    179                  if (leds & HAL_LED_4)
    180                {
    181                  P1DIR |= 0x04;
    182                    P1_3 = 0;
    183                    break;
    184                }
    185                break;*/
    186                
    187                
    188               
    189              case HAL_LED_MODE_OFF:
    190               
    191               /* if (leds & HAL_LED_1)
    192                {
    193                  P1DIR |= 0x01;
    194                  P1_0 = 1;
    195                    break;
    196                }
    197                  if (leds & HAL_LED_2)
    198                {
    199                  P1DIR |= 0x02;
    200                    P1_1 = 1;
    201                    break;
    202                }
    203                  if (leds & HAL_LED_3)
    204                {
    205                  P1DIR |= 0x03;
    206                    P1_2 = 1;
    207                    break;
    208                }
    209                  if (leds & HAL_LED_4)
    210                {
    211                  P1DIR |= 0x04;
    212                    P1_3 = 1;
    213                    break;
    214                }
    215                break;*/
    216                
    217              case HAL_LED_MODE_TOGGLE:
    218          
    219                led = HAL_LED_1;
    220                leds &= HAL_LED_ALL;
    221                sts = HalLedStatusControl.HalLedControlTable;
    222          
    223                while (leds)
    224                {
    225                  if (leds & led)
    226                  {
    227                    if (mode != HAL_LED_MODE_TOGGLE)
    228                    {
    229                      sts->mode = mode;  // ON or OFF 
    230                    }
    231                    else
    232                    {
    233                      sts->mode ^= HAL_LED_MODE_ON;  // Toggle 
    234                    }
    235                    HalLedOnOff (led, sts->mode);
    236                    leds ^= led;
    237                  }
    238                  led <<= 1;
    239                  sts++;
    240                }
    241                break;
    242          
    243              default:
    244                break;
    245            }
    246          
    247          #elif (HAL_LED == TRUE)
    248          
    249            HalLedOnOff(leds, mode);
    250          #else
    251            // HAL LED is disabled, suppress unused argument warnings
    252            (void) leds;
    253            (void) mode;
    254          #endif /* BLINK_LEDS && HAL_LED   */
    255           
    256            return ( HalLedState );
   \                     ??HalLedSet_3:
   \   000027   90....       MOV     DPTR,#HalLedState
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   F9           MOV     R1,A
   \   00002C   7F03         MOV     R7,#0x3
   \   00002E   02....       LJMP    ?BANKED_LEAVE_XDATA
   \                     ??HalLedSet_2:
   \   000031                ; Setup parameters for call to function HalLedBlink
   \   000031   7CE8         MOV     R4,#-0x18
   \   000033   7D03         MOV     R5,#0x3
   \   000035   7B05         MOV     R3,#0x5
   \   000037   7A32         MOV     R2,#0x32
   \   000039   80E9         SJMP    ??HalLedSet_4
   \                     ??HalLedSet_0:
   \   00003B   75..01       MOV     ?V0 + 2,#0x1
   \   00003E   53..0F       ANL     ?V0 + 0,#0xf
   \   000041   7E..         MOV     R6,#HalLedStatusControl & 0xff
   \   000043   7F..         MOV     R7,#(HalLedStatusControl >> 8) & 0xff
   \   000045   801D         SJMP    ??HalLedSet_5
   \                     ??HalLedSet_6:
   \   000047   E0           MOVX    A,@DPTR
   \   000048   6401         XRL     A,#0x1
   \                     ??HalLedSet_7:
   \   00004A   F0           MOVX    @DPTR,A
   \   00004B                ; Setup parameters for call to function HalLedOnOff
   \   00004B   E0           MOVX    A,@DPTR
   \   00004C   FA           MOV     R2,A
   \   00004D   A9..         MOV     R1,?V0 + 2
   \   00004F   12....       LCALL   ??HalLedOnOff?relay
   \   000052   E5..         MOV     A,?V0 + 2
   \   000054   62..         XRL     ?V0 + 0,A
   \                     ??HalLedSet_8:
   \   000056   E5..         MOV     A,?V0 + 2
   \   000058   C3           CLR     C
   \   000059   33           RLC     A
   \   00005A   F5..         MOV     ?V0 + 2,A
   \   00005C   EE           MOV     A,R6
   \   00005D   2409         ADD     A,#0x9
   \   00005F   FE           MOV     R6,A
   \   000060   EF           MOV     A,R7
   \   000061   3400         ADDC    A,#0x0
   \   000063   FF           MOV     R7,A
   \                     ??HalLedSet_5:
   \   000064   E5..         MOV     A,?V0 + 0
   \   000066   60BF         JZ      ??HalLedSet_3
   \   000068   55..         ANL     A,?V0 + 2
   \   00006A   60EA         JZ      ??HalLedSet_8
   \   00006C   7408         MOV     A,#0x8
   \   00006E   65..         XRL     A,?V0 + 1
   \   000070   8E82         MOV     DPL,R6
   \   000072   8F83         MOV     DPH,R7
   \   000074   60D1         JZ      ??HalLedSet_6
   \   000076   E5..         MOV     A,?V0 + 1
   \   000078   80D0         SJMP    ??HalLedSet_7
    257          
    258          }
    259          
    260          /***************************************************************************************************
    261           * @fn      HalLedBlink
    262           *
    263           * @brief   Blink the leds
    264           *
    265           * @param   leds       - bit mask value of leds to be blinked
    266           *          numBlinks  - number of blinks
    267           *          percent    - the percentage in each period where the led
    268           *                       will be on
    269           *          period     - length of each cycle in milliseconds
    270           *
    271           * @return  None
    272           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    273          void HalLedBlink (uint8 leds, uint8 numBlinks, uint8 percent, uint16 period)
   \                     HalLedBlink:
    274          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 0,R1
   \   000007   8A..         MOV     ?V0 + 3,R2
   \   000009   8B..         MOV     ?V0 + 2,R3
   \   00000B   8C..         MOV     ?V0 + 4,R4
   \   00000D   8D..         MOV     ?V0 + 5,R5
    275          #if (defined (BLINK_LEDS)) && (HAL_LED == TRUE)
    276            uint8 led;
    277            HalLedControl_t *sts;
    278          
    279            if (leds && percent && period)
   \   00000F   E9           MOV     A,R1
   \   000010   7003         JNZ     $+5
   \   000012   02....       LJMP    ??HalLedBlink_0 & 0xFFFF
   \   000015   EB           MOV     A,R3
   \   000016   7003         JNZ     $+5
   \   000018   02....       LJMP    ??HalLedBlink_0 & 0xFFFF
   \   00001B   EC           MOV     A,R4
   \   00001C   45..         ORL     A,?V0 + 5
   \   00001E   7003         JNZ     $+5
   \   000020   02....       LJMP    ??HalLedBlink_0 & 0xFFFF
    280            {
    281              if (percent < 100)
   \   000023   EB           MOV     A,R3
   \   000024   C3           CLR     C
   \   000025   9464         SUBB    A,#0x64
   \   000027   4003         JC      $+5
   \   000029   02....       LJMP    ??HalLedBlink_1 & 0xFFFF
    282              {
    283                led = HAL_LED_1;
   \   00002C   75..01       MOV     ?V0 + 1,#0x1
    284                leds &= HAL_LED_ALL;
   \   00002F   53..0F       ANL     ?V0 + 0,#0xf
    285                sts = HalLedStatusControl.HalLedControlTable;
   \   000032   7E..         MOV     R6,#HalLedStatusControl & 0xff
   \   000034   7F..         MOV     R7,#(HalLedStatusControl >> 8) & 0xff
   \   000036   8064         SJMP    ??HalLedBlink_2
    286          
    287                while (leds)
    288                {
    289                  if (leds & led)
   \                     ??HalLedBlink_3:
   \   000038   55..         ANL     A,?V0 + 1
   \   00003A   6052         JZ      ??HalLedBlink_4
    290                  {
    291                    /* Store the current state of the led before going to blinking */
    292                    preBlinkState |= (led & HalLedState);
   \   00003C   90....       MOV     DPTR,#HalLedState
   \   00003F   E0           MOVX    A,@DPTR
   \   000040   55..         ANL     A,?V0 + 1
   \   000042   F8           MOV     R0,A
   \   000043   90....       MOV     DPTR,#preBlinkState
   \   000046   E0           MOVX    A,@DPTR
   \   000047   48           ORL     A,R0
   \   000048   F0           MOVX    @DPTR,A
    293          
    294                    sts->mode  = HAL_LED_MODE_OFF;                    /* Stop previous blink */
   \   000049   8E82         MOV     DPL,R6
   \   00004B   8F83         MOV     DPH,R7
   \   00004D   E4           CLR     A
   \   00004E   F0           MOVX    @DPTR,A
    295                    sts->time  = period;                              /* Time for one on/off cycle */
   \   00004F   A3           INC     DPTR
   \   000050   A3           INC     DPTR
   \   000051   A3           INC     DPTR
   \   000052   E5..         MOV     A,?V0 + 4
   \   000054   F0           MOVX    @DPTR,A
   \   000055   A3           INC     DPTR
   \   000056   E5..         MOV     A,?V0 + 5
   \   000058   F0           MOVX    @DPTR,A
    296                    sts->onPct = percent;                             /* % of cycle LED is on */
   \   000059   8E82         MOV     DPL,R6
   \   00005B   8F83         MOV     DPH,R7
   \   00005D   A3           INC     DPTR
   \   00005E   A3           INC     DPTR
   \   00005F   E5..         MOV     A,?V0 + 2
   \   000061   F0           MOVX    @DPTR,A
    297                    sts->todo  = numBlinks;                           /* Number of blink cycles */
   \   000062   8E82         MOV     DPL,R6
   \   000064   8F83         MOV     DPH,R7
   \   000066   A3           INC     DPTR
   \   000067   E5..         MOV     A,?V0 + 3
   \   000069   F0           MOVX    @DPTR,A
    298                    if (!numBlinks) sts->mode |= HAL_LED_MODE_FLASH;  /* Continuous */
   \   00006A   7007         JNZ     ??HalLedBlink_5
   \   00006C   8E82         MOV     DPL,R6
   \   00006E   8F83         MOV     DPH,R7
   \   000070   7404         MOV     A,#0x4
   \   000072   F0           MOVX    @DPTR,A
    299                    sts->next = osal_GetSystemClock();                /* Start now */
   \                     ??HalLedBlink_5:
   \   000073                ; Setup parameters for call to function osal_GetSystemClock
   \   000073   12....       LCALL   ??osal_GetSystemClock?relay
   \   000076   8E82         MOV     DPL,R6
   \   000078   8F83         MOV     DPH,R7
   \   00007A   A3           INC     DPTR
   \   00007B   A3           INC     DPTR
   \   00007C   A3           INC     DPTR
   \   00007D   A3           INC     DPTR
   \   00007E   A3           INC     DPTR
   \   00007F   12....       LCALL   ?XSTORE_R2345
    300                    sts->mode |= HAL_LED_MODE_BLINK;                  /* Enable blinking */
   \   000082   8E82         MOV     DPL,R6
   \   000084   8F83         MOV     DPH,R7
   \   000086   E0           MOVX    A,@DPTR
   \   000087   D2E1         SETB    0xE0 /* A   */.1
   \   000089   F0           MOVX    @DPTR,A
    301                    leds ^= led;
   \   00008A   E5..         MOV     A,?V0 + 1
   \   00008C   62..         XRL     ?V0 + 0,A
    302                  }
    303                  led <<= 1;
   \                     ??HalLedBlink_4:
   \   00008E   E5..         MOV     A,?V0 + 1
   \   000090   C3           CLR     C
   \   000091   33           RLC     A
   \   000092   F5..         MOV     ?V0 + 1,A
    304                  sts++;
   \   000094   EE           MOV     A,R6
   \   000095   2409         ADD     A,#0x9
   \   000097   FE           MOV     R6,A
   \   000098   EF           MOV     A,R7
   \   000099   3400         ADDC    A,#0x0
   \   00009B   FF           MOV     R7,A
    305                }
   \                     ??HalLedBlink_2:
   \   00009C   E5..         MOV     A,?V0 + 0
   \   00009E   7098         JNZ     ??HalLedBlink_3
    306                osal_set_event (Hal_TaskID, HAL_LED_BLINK_EVENT);
   \   0000A0                ; Setup parameters for call to function osal_set_event
   \   0000A0   7A02         MOV     R2,#0x2
   \   0000A2   7B00         MOV     R3,#0x0
   \   0000A4   90....       MOV     DPTR,#Hal_TaskID
   \   0000A7   E0           MOVX    A,@DPTR
   \   0000A8   F9           MOV     R1,A
   \   0000A9   12....       LCALL   ??osal_set_event?relay
   \   0000AC   8009         SJMP    ??HalLedBlink_6
    307              }
    308              else
    309              {
    310                HalLedSet (leds, HAL_LED_MODE_ON);                    /* >= 100%, turn on */
   \                     ??HalLedBlink_1:
   \   0000AE                ; Setup parameters for call to function HalLedSet
   \   0000AE   7A01         MOV     R2,#0x1
   \   0000B0   8002         SJMP    ??HalLedBlink_7
    311              }
    312            }
    313            else
    314            {
    315              HalLedSet (leds, HAL_LED_MODE_OFF);                     /* No on time, turn off */
   \                     ??HalLedBlink_0:
   \   0000B2                ; Setup parameters for call to function HalLedSet
   \   0000B2   7A00         MOV     R2,#0x0
   \                     ??HalLedBlink_7:
   \   0000B4   12....       LCALL   ??HalLedSet?relay
    316            }
    317          #elif (HAL_LED == TRUE)
    318            percent = (leds & HalLedState) ? HAL_LED_MODE_OFF : HAL_LED_MODE_ON;
    319            HalLedOnOff (leds, percent);                              /* Toggle */
    320          #else
    321            // HAL LED is disabled, suppress unused argument warnings
    322            (void) leds;
    323            (void) numBlinks;
    324            (void) percent;
    325            (void) period;
    326            P1_3 = 0;
    327          #endif /* BLINK_LEDS && HAL_LED */
    328          }
   \                     ??HalLedBlink_6:
   \   0000B7   7F06         MOV     R7,#0x6
   \   0000B9   02....       LJMP    ?BANKED_LEAVE_XDATA
    329          
    330          #if (HAL_LED == TRUE)
    331          /***************************************************************************************************
    332           * @fn      HalLedUpdate
    333           *
    334           * @brief   Update leds to work with blink
    335           *
    336           * @param   none
    337           *
    338           * @return  none
    339           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    340          void HalLedUpdate (void)
   \                     HalLedUpdate:
    341          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 13
   \   000005   74F3         MOV     A,#-0xd
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    342            uint8 led;
    343            uint8 pct;
    344            uint8 leds;
    345            HalLedControl_t *sts;
    346            uint32 time;
    347            uint16 next;
    348            uint16 wait;
    349          
    350            next = 0;
   \   00000A   7405         MOV     A,#0x5
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   E4           CLR     A
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   F0           MOVX    @DPTR,A
    351            led  = HAL_LED_1;
   \   000013   85..82       MOV     DPL,?XSP + 0
   \   000016   85..83       MOV     DPH,?XSP + 1
   \   000019   04           INC     A
   \   00001A   F0           MOVX    @DPTR,A
    352            leds = HAL_LED_ALL;
   \   00001B   7403         MOV     A,#0x3
   \   00001D   12....       LCALL   ?XSTACK_DISP0_8
   \   000020   740F         MOV     A,#0xf
   \   000022   F0           MOVX    @DPTR,A
    353            sts = HalLedStatusControl.HalLedControlTable;
   \   000023   7401         MOV     A,#0x1
   \   000025   12....       LCALL   ?XSTACK_DISP0_8
   \   000028   74..         MOV     A,#HalLedStatusControl & 0xff
   \   00002A   F0           MOVX    @DPTR,A
   \   00002B   A3           INC     DPTR
   \   00002C   74..         MOV     A,#(HalLedStatusControl >> 8) & 0xff
   \   00002E   F0           MOVX    @DPTR,A
    354          
    355            /* Check if sleep is active or not */
    356            if (!HalLedStatusControl.sleepActive)
   \   00002F   90....       MOV     DPTR,#HalLedStatusControl + 36
   \   000032   E0           MOVX    A,@DPTR
   \   000033   6003         JZ      $+5
   \   000035   02....       LJMP    ??HalLedUpdate_0 & 0xFFFF
    357            {
    358              while (leds)
    359              {
    360                if (leds & led)
   \                     ??HalLedUpdate_1:
   \   000038   85..82       MOV     DPL,?XSP + 0
   \   00003B   85..83       MOV     DPH,?XSP + 1
   \   00003E   C082         PUSH    DPL
   \   000040   C083         PUSH    DPH
   \   000042   7403         MOV     A,#0x3
   \   000044   12....       LCALL   ?XSTACK_DISP0_8
   \   000047   E0           MOVX    A,@DPTR
   \   000048   D083         POP     DPH
   \   00004A   D082         POP     DPL
   \   00004C   F8           MOV     R0,A
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   58           ANL     A,R0
   \   00004F   7003         JNZ     $+5
   \   000051   02....       LJMP    ??HalLedUpdate_2 & 0xFFFF
    361                {
    362                  if (sts->mode & HAL_LED_MODE_BLINK)
   \   000054   7401         MOV     A,#0x1
   \   000056   12....       LCALL   ?XSTACK_DISP0_8
   \   000059   12....       LCALL   ?Subroutine1 & 0xFFFF
   \                     ??CrossCallReturnLabel_0:
   \   00005C   4003         JC      $+5
   \   00005E   02....       LJMP    ??HalLedUpdate_3 & 0xFFFF
    363                  {
    364                    time = osal_GetSystemClock();
   \   000061                ; Setup parameters for call to function osal_GetSystemClock
   \   000061   12....       LCALL   ??osal_GetSystemClock?relay
   \   000064   7409         MOV     A,#0x9
   \   000066   12....       LCALL   ?XSTACK_DISP0_8
   \   000069   12....       LCALL   ?XSTORE_R2345
    365                    if (time >= sts->next)
   \   00006C   7401         MOV     A,#0x1
   \   00006E   12....       LCALL   ?XSTACK_DISP0_8
   \   000071   E0           MOVX    A,@DPTR
   \   000072   2405         ADD     A,#0x5
   \   000074   F8           MOV     R0,A
   \   000075   A3           INC     DPTR
   \   000076   E0           MOVX    A,@DPTR
   \   000077   3400         ADDC    A,#0x0
   \   000079   F9           MOV     R1,A
   \   00007A   7407         MOV     A,#0x7
   \   00007C   12....       LCALL   ?XSTACK_DISP0_8
   \   00007F   E8           MOV     A,R0
   \   000080   F0           MOVX    @DPTR,A
   \   000081   A3           INC     DPTR
   \   000082   E9           MOV     A,R1
   \   000083   F0           MOVX    @DPTR,A
   \   000084   7407         MOV     A,#0x7
   \   000086   12....       LCALL   ?XSTACK_DISP0_8
   \   000089   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   00008C   12....       LCALL   ?L_MOV_X
   \   00008F   7409         MOV     A,#0x9
   \   000091   12....       LCALL   ?XSTACK_DISP0_8
   \   000094   78..         MOV     R0,#?V0 + 0
   \   000096   12....       LCALL   ?UL_GT_X
   \   000099   5003         JNC     $+5
   \   00009B   02....       LJMP    ??HalLedUpdate_4 & 0xFFFF
    366                    {
    367                      if (sts->mode & HAL_LED_MODE_ON)
   \   00009E   7401         MOV     A,#0x1
   \   0000A0   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A3   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_12:
   \   0000A6   A3           INC     DPTR
   \   0000A7   A3           INC     DPTR
   \   0000A8   E0           MOVX    A,@DPTR
   \   0000A9   F8           MOV     R0,A
   \   0000AA   7401         MOV     A,#0x1
   \   0000AC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000AF   E0           MOVX    A,@DPTR
   \   0000B0   F9           MOV     R1,A
   \   0000B1   A3           INC     DPTR
   \   0000B2   E0           MOVX    A,@DPTR
   \   0000B3   F583         MOV     DPH,A
   \   0000B5   8982         MOV     DPL,R1
   \   0000B7   E0           MOVX    A,@DPTR
   \   0000B8   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000BA   504E         JNC     ??HalLedUpdate_5
    368                      {
    369                        pct = 100 - sts->onPct;               /* Percentage of cycle for off */
   \   0000BC   7464         MOV     A,#0x64
   \   0000BE   C3           CLR     C
   \   0000BF   98           SUBB    A,R0
   \   0000C0   C0E0         PUSH    A
   \   0000C2   7404         MOV     A,#0x4
   \   0000C4   12....       LCALL   ?XSTACK_DISP0_8
   \   0000C7   D0E0         POP     A
   \   0000C9   F0           MOVX    @DPTR,A
    370                        sts->mode &= ~HAL_LED_MODE_ON;        /* Say it's not on */
   \   0000CA   7401         MOV     A,#0x1
   \   0000CC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000CF   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_2:
   \   0000D2   C2E0         CLR     0xE0 /* A   */.0
   \   0000D4   F0           MOVX    @DPTR,A
    371                        HalLedOnOff (led, HAL_LED_MODE_OFF);  /* Turn it off */
   \   0000D5                ; Setup parameters for call to function HalLedOnOff
   \   0000D5   7A00         MOV     R2,#0x0
   \   0000D7   12....       LCALL   ?Subroutine4 & 0xFFFF
    372          
    373                        if (!(sts->mode & HAL_LED_MODE_FLASH))
   \                     ??CrossCallReturnLabel_8:
   \   0000DA   7401         MOV     A,#0x1
   \   0000DC   12....       LCALL   ?XSTACK_DISP0_8
   \   0000DF   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_3:
   \   0000E2   A2E2         MOV     C,0xE0 /* A   */.2
   \   0000E4   403B         JC      ??CrossCallReturnLabel_9
    374                        {
    375                          sts->todo--;                        /* Not continuous, reduce count */
   \   0000E6   7401         MOV     A,#0x1
   \   0000E8   12....       LCALL   ?XSTACK_DISP0_8
   \   0000EB   E0           MOVX    A,@DPTR
   \   0000EC   2401         ADD     A,#0x1
   \   0000EE   08           INC     R0
   \   0000EF   A3           INC     DPTR
   \   0000F0   E0           MOVX    A,@DPTR
   \   0000F1   3400         ADDC    A,#0x0
   \   0000F3   F9           MOV     R1,A
   \   0000F4   8882         MOV     DPL,R0
   \   0000F6   8983         MOV     DPH,R1
   \   0000F8   E0           MOVX    A,@DPTR
   \   0000F9   14           DEC     A
   \   0000FA   F0           MOVX    @DPTR,A
    376                          if (!sts->todo)
   \   0000FB   7024         JNZ     ??CrossCallReturnLabel_9
    377                          {
    378                            sts->mode ^= HAL_LED_MODE_BLINK;  /* No more blinks */
   \   0000FD   7401         MOV     A,#0x1
   \   0000FF   12....       LCALL   ?XSTACK_DISP0_8
   \   000102   12....       LCALL   ?Subroutine2 & 0xFFFF
    379                          }
    380                        }
    381                      }
   \                     ??CrossCallReturnLabel_4:
   \   000105   6402         XRL     A,#0x2
   \   000107   F0           MOVX    @DPTR,A
   \   000108   8017         SJMP    ??CrossCallReturnLabel_9
    382                      else
    383                      {
    384                        pct = sts->onPct;                     /* Percentage of cycle for on */
   \                     ??HalLedUpdate_5:
   \   00010A   7404         MOV     A,#0x4
   \   00010C   12....       LCALL   ?XSTACK_DISP0_8
   \   00010F   E8           MOV     A,R0
   \   000110   F0           MOVX    @DPTR,A
    385                        sts->mode |= HAL_LED_MODE_ON;         /* Say it's on */
   \   000111   7401         MOV     A,#0x1
   \   000113   12....       LCALL   ?XSTACK_DISP0_8
   \   000116   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   000119   D2E0         SETB    0xE0 /* A   */.0
   \   00011B   F0           MOVX    @DPTR,A
    386                        HalLedOnOff (led, HAL_LED_MODE_ON);   /* Turn it on */
   \   00011C                ; Setup parameters for call to function HalLedOnOff
   \   00011C   7A01         MOV     R2,#0x1
   \   00011E   12....       LCALL   ?Subroutine4 & 0xFFFF
    387                      }
    388          
    389                      if (sts->mode & HAL_LED_MODE_BLINK)
   \                     ??CrossCallReturnLabel_9:
   \   000121   7401         MOV     A,#0x1
   \   000123   12....       LCALL   ?XSTACK_DISP0_8
   \   000126   12....       LCALL   ?Subroutine1 & 0xFFFF
   \                     ??CrossCallReturnLabel_1:
   \   000129   505F         JNC     ??HalLedUpdate_6
    390                      {
    391                        wait = (((uint32)pct * (uint32)sts->time) / 100);
   \   00012B   7404         MOV     A,#0x4
   \   00012D   12....       LCALL   ?XSTACK_DISP0_8
   \   000130   E0           MOVX    A,@DPTR
   \   000131   F5..         MOV     ?V0 + 4,A
   \   000133   E4           CLR     A
   \   000134   F5..         MOV     ?V0 + 5,A
   \   000136   F5..         MOV     ?V0 + 6,A
   \   000138   F5..         MOV     ?V0 + 7,A
   \   00013A   04           INC     A
   \   00013B   12....       LCALL   ?XSTACK_DISP0_8
   \   00013E   12....       LCALL   ??Subroutine7_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_11:
   \   000141   A3           INC     DPTR
   \   000142   A3           INC     DPTR
   \   000143   A3           INC     DPTR
   \   000144   E0           MOVX    A,@DPTR
   \   000145   F5..         MOV     ?V0 + 0,A
   \   000147   A3           INC     DPTR
   \   000148   E0           MOVX    A,@DPTR
   \   000149   F5..         MOV     ?V0 + 1,A
   \   00014B   E4           CLR     A
   \   00014C   F5..         MOV     ?V0 + 2,A
   \   00014E   F5..         MOV     ?V0 + 3,A
   \   000150   78..         MOV     R0,#?V0 + 4
   \   000152   79..         MOV     R1,#?V0 + 0
   \   000154   12....       LCALL   ?L_MUL
   \   000157   90....       MOV     DPTR,#__Constant_64
   \   00015A   78..         MOV     R0,#?V0 + 0
   \   00015C   12....       LCALL   ?L_MOV_X
   \   00015F   78..         MOV     R0,#?V0 + 4
   \   000161   79..         MOV     R1,#?V0 + 0
   \   000163   12....       LCALL   ?UL_DIV_MOD
   \   000166   AE..         MOV     R6,?V0 + 4
   \   000168   AF..         MOV     R7,?V0 + 5
    392                        sts->next = time + wait;
   \   00016A   7409         MOV     A,#0x9
   \   00016C   12....       LCALL   ?XSTACK_DISP0_8
   \   00016F   8E..         MOV     ?V0 + 0,R6
   \   000171   8F..         MOV     ?V0 + 1,R7
   \   000173   E4           CLR     A
   \   000174   F5..         MOV     ?V0 + 2,A
   \   000176   F5..         MOV     ?V0 + 3,A
   \   000178   78..         MOV     R0,#?V0 + 0
   \   00017A   12....       LCALL   ?L_ADD_X
   \   00017D   7407         MOV     A,#0x7
   \   00017F   12....       LCALL   ?XSTACK_DISP0_8
   \   000182   12....       LCALL   ?Subroutine3 & 0xFFFF
    393                      }
   \                     ??CrossCallReturnLabel_7:
   \   000185   12....       LCALL   ?L_MOV_TO_X
   \   000188   804C         SJMP    ??HalLedUpdate_7
    394                      else
    395                      {
    396                        /* no more blink, no more wait */
    397                        wait = 0;
   \                     ??HalLedUpdate_6:
   \   00018A   7E00         MOV     R6,#0x0
   \   00018C   7F00         MOV     R7,#0x0
    398                        /* After blinking, set the LED back to the state before it blinks */
    399                        HalLedSet (led, ((preBlinkState & led)!=0)?HAL_LED_MODE_ON:HAL_LED_MODE_OFF);
   \   00018E   85..82       MOV     DPL,?XSP + 0
   \   000191   85..83       MOV     DPH,?XSP + 1
   \   000194   C082         PUSH    DPL
   \   000196   C083         PUSH    DPH
   \   000198   90....       MOV     DPTR,#preBlinkState
   \   00019B   E0           MOVX    A,@DPTR
   \   00019C   D083         POP     DPH
   \   00019E   D082         POP     DPL
   \   0001A0   F8           MOV     R0,A
   \   0001A1   E0           MOVX    A,@DPTR
   \   0001A2   58           ANL     A,R0
   \   0001A3   6004         JZ      ??HalLedUpdate_8
   \   0001A5   7A01         MOV     R2,#0x1
   \   0001A7   8002         SJMP    ??HalLedUpdate_9
   \                     ??HalLedUpdate_8:
   \   0001A9   7A00         MOV     R2,#0x0
   \                     ??HalLedUpdate_9:
   \   0001AB                ; Setup parameters for call to function HalLedSet
   \   0001AB   E0           MOVX    A,@DPTR
   \   0001AC   F9           MOV     R1,A
   \   0001AD   12....       LCALL   ??HalLedSet?relay
    400                        /* Clear the saved bit */
    401                        preBlinkState &= (led ^ 0xFF);
   \   0001B0   85..82       MOV     DPL,?XSP + 0
   \   0001B3   85..83       MOV     DPH,?XSP + 1
   \   0001B6   E0           MOVX    A,@DPTR
   \   0001B7   F4           CPL     A
   \   0001B8   F8           MOV     R0,A
   \   0001B9   90....       MOV     DPTR,#preBlinkState
   \   0001BC   E0           MOVX    A,@DPTR
   \   0001BD   58           ANL     A,R0
   \   0001BE   F0           MOVX    @DPTR,A
   \   0001BF   8015         SJMP    ??HalLedUpdate_7
    402                      }
    403                    }
    404                    else
    405                    {
    406                      wait = sts->next - time;  /* Time left */
   \                     ??HalLedUpdate_4:
   \   0001C1   7409         MOV     A,#0x9
   \   0001C3   12....       LCALL   ?XSTACK_DISP0_8
   \   0001C6   78..         MOV     R0,#?V0 + 4
   \   0001C8   12....       LCALL   ?L_MOV_X
   \   0001CB   E5..         MOV     A,?V0 + 0
   \   0001CD   C3           CLR     C
   \   0001CE   95..         SUBB    A,?V0 + 4
   \   0001D0   FE           MOV     R6,A
   \   0001D1   E5..         MOV     A,?V0 + 1
   \   0001D3   95..         SUBB    A,?V0 + 5
   \   0001D5   FF           MOV     R7,A
    407                    }
    408          
    409                    if (!next || ( wait && (wait < next) ))
   \                     ??HalLedUpdate_7:
   \   0001D6   7405         MOV     A,#0x5
   \   0001D8   12....       LCALL   ?XSTACK_DISP0_8
   \   0001DB   E0           MOVX    A,@DPTR
   \   0001DC   F8           MOV     R0,A
   \   0001DD   A3           INC     DPTR
   \   0001DE   E0           MOVX    A,@DPTR
   \   0001DF   F9           MOV     R1,A
   \   0001E0   E8           MOV     A,R0
   \   0001E1   49           ORL     A,R1
   \   0001E2   600B         JZ      ??HalLedUpdate_10
   \   0001E4   EE           MOV     A,R6
   \   0001E5   4F           ORL     A,R7
   \   0001E6   6011         JZ      ??HalLedUpdate_3
   \   0001E8   C3           CLR     C
   \   0001E9   EE           MOV     A,R6
   \   0001EA   98           SUBB    A,R0
   \   0001EB   EF           MOV     A,R7
   \   0001EC   99           SUBB    A,R1
   \   0001ED   500A         JNC     ??HalLedUpdate_3
    410                    {
    411                      next = wait;
   \                     ??HalLedUpdate_10:
   \   0001EF   7405         MOV     A,#0x5
   \   0001F1   12....       LCALL   ?XSTACK_DISP0_8
   \   0001F4   EE           MOV     A,R6
   \   0001F5   F0           MOVX    @DPTR,A
   \   0001F6   A3           INC     DPTR
   \   0001F7   EF           MOV     A,R7
   \   0001F8   F0           MOVX    @DPTR,A
    412                    }
    413                  }
    414                  leds ^= led;
   \                     ??HalLedUpdate_3:
   \   0001F9   85..82       MOV     DPL,?XSP + 0
   \   0001FC   85..83       MOV     DPH,?XSP + 1
   \   0001FF   E0           MOVX    A,@DPTR
   \   000200   F8           MOV     R0,A
   \   000201   7403         MOV     A,#0x3
   \   000203   12....       LCALL   ?XSTACK_DISP0_8
   \   000206   E0           MOVX    A,@DPTR
   \   000207   68           XRL     A,R0
   \   000208   F0           MOVX    @DPTR,A
    415                }
    416                led <<= 1;
   \                     ??HalLedUpdate_2:
   \   000209   85..82       MOV     DPL,?XSP + 0
   \   00020C   85..83       MOV     DPH,?XSP + 1
   \   00020F   E0           MOVX    A,@DPTR
   \   000210   C3           CLR     C
   \   000211   33           RLC     A
   \   000212   F0           MOVX    @DPTR,A
    417                sts++;
   \   000213   7401         MOV     A,#0x1
   \   000215   12....       LCALL   ?XSTACK_DISP0_8
   \   000218   E0           MOVX    A,@DPTR
   \   000219   2409         ADD     A,#0x9
   \   00021B   F8           MOV     R0,A
   \   00021C   A3           INC     DPTR
   \   00021D   E0           MOVX    A,@DPTR
   \   00021E   3400         ADDC    A,#0x0
   \   000220   F9           MOV     R1,A
   \   000221   7401         MOV     A,#0x1
   \   000223   12....       LCALL   ?XSTACK_DISP0_8
   \   000226   E8           MOV     A,R0
   \   000227   F0           MOVX    @DPTR,A
   \   000228   A3           INC     DPTR
   \   000229   E9           MOV     A,R1
   \   00022A   F0           MOVX    @DPTR,A
    418              }
   \   00022B   7403         MOV     A,#0x3
   \   00022D   12....       LCALL   ?XSTACK_DISP0_8
   \   000230   E0           MOVX    A,@DPTR
   \   000231   6003         JZ      $+5
   \   000233   02....       LJMP    ??HalLedUpdate_1 & 0xFFFF
    419          
    420              if (next)
   \   000236   7405         MOV     A,#0x5
   \   000238   12....       LCALL   ?XSTACK_DISP0_8
   \   00023B   E0           MOVX    A,@DPTR
   \   00023C   F8           MOV     R0,A
   \   00023D   A3           INC     DPTR
   \   00023E   E0           MOVX    A,@DPTR
   \   00023F   F9           MOV     R1,A
   \   000240   E8           MOV     A,R0
   \   000241   49           ORL     A,R1
   \   000242   6016         JZ      ??HalLedUpdate_0
    421              {
    422                osal_start_timerEx(Hal_TaskID, HAL_LED_BLINK_EVENT, next);   /* Schedule event */
   \   000244                ; Setup parameters for call to function osal_start_timerEx
   \   000244   7405         MOV     A,#0x5
   \   000246   12....       LCALL   ?XSTACK_DISP0_8
   \   000249   E0           MOVX    A,@DPTR
   \   00024A   FC           MOV     R4,A
   \   00024B   A3           INC     DPTR
   \   00024C   E0           MOVX    A,@DPTR
   \   00024D   FD           MOV     R5,A
   \   00024E   7A02         MOV     R2,#0x2
   \   000250   7B00         MOV     R3,#0x0
   \   000252   90....       MOV     DPTR,#Hal_TaskID
   \   000255   E0           MOVX    A,@DPTR
   \   000256   F9           MOV     R1,A
   \   000257   12....       LCALL   ??osal_start_timerEx?relay
    423              }
    424            }
    425          }
   \                     ??HalLedUpdate_0:
   \   00025A   740D         MOV     A,#0xd
   \   00025C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00025F   7F08         MOV     R7,#0x8
   \   000261   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006                REQUIRE ??Subroutine6_0
   \   000006                ; // Fall through to label ??Subroutine6_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine6_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F9           MOV     R1,A
   \   000002   12....       LCALL   ??HalLedOnOff?relay
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_15:
   \   000003   78..         MOV     R0,#?V0 + 0
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_14:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002                REQUIRE ??Subroutine7_0
   \   000002                ; // Fall through to label ??Subroutine7_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine7_0:
   \   000000   A3           INC     DPTR
   \   000001   E0           MOVX    A,@DPTR
   \   000002   F583         MOV     DPH,A
   \   000004   8882         MOV     DPL,R0
   \   000006   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_13:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   A2E1         MOV     C,0xE0 /* A   */.1
   \   000006   22           RET
    426          
    427          /***************************************************************************************************
    428           * @fn      HalLedOnOff
    429           *
    430           * @brief   Turns specified LED ON or OFF
    431           *
    432           * @param   leds - LED bit mask
    433           *          mode - LED_ON,LED_OFF,
    434           *
    435           * @return  none
    436           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    437          void HalLedOnOff (uint8 leds, uint8 mode)
   \                     HalLedOnOff:
    438          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    439            if (leds & HAL_LED_1)
   \   000004   E9           MOV     A,R1
   \   000005   A2E0         MOV     C,0xE0 /* A   */.0
   \   000007   500B         JNC     ??HalLedOnOff_0
    440            {
    441              if (mode == HAL_LED_MODE_ON)
   \   000009   7401         MOV     A,#0x1
   \   00000B   6A           XRL     A,R2
   \   00000C   7004         JNZ     ??HalLedOnOff_1
    442              {
    443                HAL_TURN_ON_LED1();
   \   00000E   C290         CLR     0x90.0
   \   000010   8002         SJMP    ??HalLedOnOff_0
    444              }
    445              else
    446              {
    447                HAL_TURN_OFF_LED1();
   \                     ??HalLedOnOff_1:
   \   000012   D290         SETB    0x90.0
    448              }
    449            }
    450          
    451            if (leds & HAL_LED_2)
   \                     ??HalLedOnOff_0:
   \   000014   E9           MOV     A,R1
   \   000015   A2E1         MOV     C,0xE0 /* A   */.1
   \   000017   500B         JNC     ??HalLedOnOff_2
    452            {
    453              if (mode == HAL_LED_MODE_ON)
   \   000019   7401         MOV     A,#0x1
   \   00001B   6A           XRL     A,R2
   \   00001C   7004         JNZ     ??HalLedOnOff_3
    454              {
    455                HAL_TURN_ON_LED2();
   \   00001E   C291         CLR     0x90.1
   \   000020   8002         SJMP    ??HalLedOnOff_2
    456              }
    457              else
    458              {
    459                HAL_TURN_OFF_LED2();
   \                     ??HalLedOnOff_3:
   \   000022   D291         SETB    0x90.1
    460              }
    461            }
    462          
    463            if (leds & HAL_LED_3)
   \                     ??HalLedOnOff_2:
   \   000024   E9           MOV     A,R1
   \   000025   A2E2         MOV     C,0xE0 /* A   */.2
   \   000027   500B         JNC     ??HalLedOnOff_4
    464            {
    465              if (mode == HAL_LED_MODE_ON)
   \   000029   7401         MOV     A,#0x1
   \   00002B   6A           XRL     A,R2
   \   00002C   7004         JNZ     ??HalLedOnOff_5
    466              {
    467                HAL_TURN_ON_LED3();
   \   00002E   C292         CLR     0x90.2
   \   000030   8002         SJMP    ??HalLedOnOff_4
    468              }
    469              else
    470              {
    471                HAL_TURN_OFF_LED3();
   \                     ??HalLedOnOff_5:
   \   000032   D292         SETB    0x90.2
    472              }
    473            }
    474          
    475            if (leds & HAL_LED_4)
   \                     ??HalLedOnOff_4:
   \   000034   E9           MOV     A,R1
   \   000035   A2E3         MOV     C,0xE0 /* A   */.3
   \   000037   500B         JNC     ??HalLedOnOff_6
    476            {
    477              if (mode == HAL_LED_MODE_ON)
   \   000039   7401         MOV     A,#0x1
   \   00003B   6A           XRL     A,R2
   \   00003C   7004         JNZ     ??HalLedOnOff_7
    478              {
    479                HAL_TURN_ON_LED4();
   \   00003E   C293         CLR     0x90.3
   \   000040   8005         SJMP    ??HalLedOnOff_8
    480              }
    481              else
    482              {
    483                HAL_TURN_OFF_LED4();
   \                     ??HalLedOnOff_7:
   \   000042   D293         SETB    0x90.3
    484              }
    485            }
    486          
    487            /* Remember current state */
    488            if (mode)
   \                     ??HalLedOnOff_6:
   \   000044   EA           MOV     A,R2
   \   000045   6007         JZ      ??HalLedOnOff_9
    489            {
    490              HalLedState |= leds;
   \                     ??HalLedOnOff_8:
   \   000047   90....       MOV     DPTR,#HalLedState
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   49           ORL     A,R1
   \   00004C   8009         SJMP    ??HalLedOnOff_10
    491            }
    492            else
    493            {
    494              HalLedState &= (leds ^ 0xFF);
   \                     ??HalLedOnOff_9:
   \   00004E   74FF         MOV     A,#-0x1
   \   000050   69           XRL     A,R1
   \   000051   F8           MOV     R0,A
   \   000052   90....       MOV     DPTR,#HalLedState
   \   000055   E0           MOVX    A,@DPTR
   \   000056   58           ANL     A,R0
    495            }
   \                     ??HalLedOnOff_10:
   \   000057   80..         SJMP    ??Subroutine8_0
   \   000059                REQUIRE _A_P1
    496          }
    497          #endif /* HAL_LED */
    498          
    499          /***************************************************************************************************
    500           * @fn      HalGetLedState
    501           *
    502           * @brief   Dim LED2 - Dim (set level) of LED2
    503           *
    504           * @param   none
    505           *
    506           * @return  led state
    507           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    508          uint8 HalLedGetState ()
   \                     HalLedGetState:
    509          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    510          #if (HAL_LED == TRUE)
    511            return HalLedState;
   \   000004   90....       MOV     DPTR,#HalLedState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   F9           MOV     R1,A
   \   000009   80..         SJMP    ??Subroutine9_0
    512          #else
    513            return 0;
    514          #endif
    515          }
    516          
    517          /***************************************************************************************************
    518           * @fn      HalLedEnterSleep
    519           *
    520           * @brief   Store current LEDs state before sleep
    521           *
    522           * @param   none
    523           *
    524           * @return  none
    525           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    526          void HalLedEnterSleep( void )
   \                     HalLedEnterSleep:
    527          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    528          #ifdef BLINK_LEDS
    529            /* Sleep ON */
    530            HalLedStatusControl.sleepActive = TRUE;
   \   000004   90....       MOV     DPTR,#HalLedStatusControl + 36
   \   000007   7401         MOV     A,#0x1
   \   000009   F0           MOVX    @DPTR,A
    531          #endif /* BLINK_LEDS */
    532          
    533          #if (HAL_LED == TRUE)
    534            /* Save the state of each led */
    535            HalSleepLedState = 0;
    536            HalSleepLedState |= HAL_STATE_LED1();
   \   00000A   E590         MOV     A,0x90
   \   00000C   FB           MOV     R3,A
    537            HalSleepLedState |= HAL_STATE_LED2() << 1;
   \   00000D   E590         MOV     A,0x90
   \   00000F   F8           MOV     R0,A
    538            HalSleepLedState |= HAL_STATE_LED3() << 2;
   \   000010   E590         MOV     A,0x90
   \   000012   F9           MOV     R1,A
    539            HalSleepLedState |= HAL_STATE_LED4() << 3;
   \   000013   E590         MOV     A,0x90
   \   000015   6408         XRL     A,#0x8
   \   000017   5408         ANL     A,#0x8
   \   000019   FA           MOV     R2,A
   \   00001A   7404         MOV     A,#0x4
   \   00001C   69           XRL     A,R1
   \   00001D   5404         ANL     A,#0x4
   \   00001F   F9           MOV     R1,A
   \   000020   7402         MOV     A,#0x2
   \   000022   68           XRL     A,R0
   \   000023   5402         ANL     A,#0x2
   \   000025   F8           MOV     R0,A
   \   000026   D2F0         SETB    B.0
   \   000028   EB           MOV     A,R3
   \   000029   A2E0         MOV     C,0xE0 /* A   */.0
   \   00002B   30F001       JNB     B.0,??HalLedEnterSleep_0
   \   00002E   B3           CPL     C
   \                     ??HalLedEnterSleep_0:
   \   00002F   E4           CLR     A
   \   000030   33           RLC     A
   \   000031   48           ORL     A,R0
   \   000032   49           ORL     A,R1
   \   000033   4A           ORL     A,R2
   \   000034   90....       MOV     DPTR,#HalSleepLedState
   \   000037   F0           MOVX    @DPTR,A
    540          
    541            /* TURN OFF all LEDs to save power */
    542            HalLedOnOff (HAL_LED_ALL, HAL_LED_MODE_OFF);
   \   000038                ; Setup parameters for call to function HalLedOnOff
   \   000038   7A00         MOV     R2,#0x0
   \   00003A   790F         MOV     R1,#0xf
   \   00003C   12....       LCALL   ??HalLedOnOff?relay
    543          #endif /* HAL_LED */
    544          
    545          }
   \   00003F   80..         SJMP    ??Subroutine9_0
   \   000041                REQUIRE _A_P1
    546          
    547          /***************************************************************************************************
    548           * @fn      HalLedExitSleep
    549           *
    550           * @brief   Restore current LEDs state after sleep
    551           *
    552           * @param   none
    553           *
    554           * @return  none
    555           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    556          void HalLedExitSleep( void )
   \                     HalLedExitSleep:
    557          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    558          #if (HAL_LED == TRUE)
    559            /* Load back the saved state */
    560            HalLedOnOff(HalSleepLedState, HAL_LED_MODE_ON);
   \   000004                ; Setup parameters for call to function HalLedOnOff
   \   000004   7A01         MOV     R2,#0x1
   \   000006   90....       MOV     DPTR,#HalSleepLedState
   \   000009   12....       LCALL   ??Subroutine6_0 & 0xFFFF
    561          
    562            /* Restart - This takes care BLINKING LEDS */
    563            HalLedUpdate();
   \                     ??CrossCallReturnLabel_10:
   \   00000C                ; Setup parameters for call to function HalLedUpdate
   \   00000C   12....       LCALL   ??HalLedUpdate?relay
    564          #endif /* HAL_LED */
    565          
    566          #ifdef BLINK_LEDS
    567            /* Sleep OFF */
    568            HalLedStatusControl.sleepActive = FALSE;
   \   00000F   80..         SJMP    ?Subroutine0
    569          #endif /* BLINK_LEDS */
    570          }

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_64:
   \   000000   64000000     DD 100

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLedInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLedInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLedSet?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLedSet

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLedBlink?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLedBlink

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLedUpdate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLedUpdate

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLedOnOff?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLedOnOff

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLedGetState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLedGetState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLedEnterSleep?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLedEnterSleep

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLedExitSleep?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLedExitSleep
    571          
    572          /***************************************************************************************************
    573          ***************************************************************************************************/
    574          
    575          
    576          
    577          

   Maximum stack usage in bytes:

     Function                 ISTACK PSTACK XSTACK
     --------                 ------ ------ ------
     HalLedBlink                  1      0     25
       -> osal_GetSystemClock     0      0     28
       -> osal_set_event          0      0     28
       -> HalLedSet               0      0     28
       -> HalLedSet               0      0     28
     HalLedEnterSleep             2      0      0
       -> HalLedOnOff             4      0      0
     HalLedExitSleep              2      0      0
       -> HalLedOnOff             4      0      0
       -> HalLedUpdate            4      0      0
     HalLedGetState               2      0      0
     HalLedInit                   2      0      0
       -> HalLedSet               4      0      0
     HalLedOnOff                  2      0     29
     HalLedSet                    1      0     40
       -> HalLedBlink             0      0     22
       -> HalLedBlink             0      0     22
       -> HalLedOnOff             0      0     22
     HalLedUpdate                 2      0     29
       -> osal_GetSystemClock     0      0     58
       -> HalLedOnOff             0      0     58
       -> HalLedOnOff             0      0     58
       -> HalLedSet               0      0     58
       -> osal_start_timerEx      0      0     58


   Segment part sizes:

     Function/Label           Bytes
     --------------           -----
     _A_P1                       1
     P1DIR                       1
     HalLedState                 1
     HalSleepLedState            1
     preBlinkState               1
     HalLedStatusControl        37
     HalLedInit                 17
     ?Subroutine0                4
     ??Subroutine8_0             1
     ??Subroutine9_0             7
     HalLedSet                 122
     HalLedBlink               188
     HalLedUpdate              612
     ?Subroutine4                6
     ??Subroutine6_0             6
     ?Subroutine3                6
     ?Subroutine2                5
     ?Subroutine5                2
     ??Subroutine7_0             7
     ?Subroutine1                7
     HalLedOnOff                89
     HalLedGetState             11
     HalLedEnterSleep           65
     HalLedExitSleep            17
     __Constant_64               4
     ??HalLedInit?relay          6
     ??HalLedSet?relay           6
     ??HalLedBlink?relay         6
     ??HalLedUpdate?relay        6
     ??HalLedOnOff?relay         6
     ??HalLedGetState?relay      6
     ??HalLedEnterSleep?relay    6
     ??HalLedExitSleep?relay     6

 
 1 172 bytes in segment BANKED_CODE
    48 bytes in segment BANK_RELAYS
     2 bytes in segment SFR_AN
     4 bytes in segment XDATA_ROM_C
    40 bytes in segment XDATA_Z
 
 1 220 bytes of CODE  memory
     0 bytes of CONST memory (+ 4 bytes shared)
     0 bytes of DATA  memory (+ 2 bytes shared)
    40 bytes of XDATA memory

Errors: none
Warnings: none
