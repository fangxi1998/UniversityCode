###############################################################################
#                                                                             #
# IAR C/C++ Compiler V7.51A/W32 for 8051                25/Dec/2012  10:17:02 #
# Copyright 2004-2009 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2. #
#                          2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zstac #
#                          k\ZMain\TI2530DB\ZMain.c                           #
#    Command line       =  -f "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC253 #
#                          0-2.2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\z #
#                          stack\Samples\MyfirstAPP\CC2530DB\..\..\..\Tools\C #
#                          C2530DB\f8wCoord.cfg" (-DCPU32MHZ                  #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DZDO_COORDINATOR -DRTR_NWK -DBLINK_LEDS) -f     #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\..\..\..\Tools\CC25 #
#                          30DB\f8wConfig.cfg" (-DSECURE=0                    #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x02000000                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\ZMain\TI2530DB\ZMain.c" -D ZTOOL_P1 -D MT_TASK  #
#                          -D MT_SYS_FUNC -D MT_ZDO_FUNC -D                   #
#                          LCD_SUPPORTED=DEBUG -D HAL_UART=TRUE -D            #
#                          SERIAL_APP_PORT=0 -D HOLD_AUTO_START -D            #
#                          DH_AD_KEY_DEVICE -lC "D:\个人重要资料(勿删)\yuanwm #
#                          \桌面\ZStack-CC2530-2.2.0-1.3.0\ZStack-CC2530-2.2. #
#                          0-1.3.0\Projects\zstack\Samples\MyfirstAPP\CC2530D #
#                          B\CoordinatorEB\List\" -lA                         #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\CoordinatorEB\List\ #
#                          " --diag_suppress Pe001,Pa010 -o                   #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\CoordinatorEB\Obj\" #
#                           -e --require_prototypes --debug --core=plain      #
#                          --dptr=16,1 --data_model=large                     #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 8 -I "D:\个人重要资料(勿删)\yuan #
#                          wm\桌面\ZStack-CC2530-2.2.0-1.3.0\ZStack-CC2530-2. #
#                          2.0-1.3.0\Projects\zstack\Samples\MyfirstAPP\CC253 #
#                          0DB\" -I "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack #
#                          -CC2530-2.2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Proj #
#                          ects\zstack\Samples\MyfirstAPP\CC2530DB\..\SOURCE\ #
#                          " -I "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2 #
#                          530-2.2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects #
#                          \zstack\Samples\MyfirstAPP\CC2530DB\..\..\..\ZMAIN #
#                          \TI2530DB\" -I "D:\个人重要资料(勿删)\yuanwm\桌面\ #
#                          ZStack-CC2530-2.2.0-1.3.0\ZStack-CC2530-2.2.0-1.3. #
#                          0\Projects\zstack\Samples\MyfirstAPP\CC2530DB\..\. #
#                          .\..\..\..\COMPONENTS\MT\" -I                      #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\..\..\..\..\..\COMP #
#                          ONENTS\HAL\INCLUDE\" -I "D:\个人重要资料(勿删)\yua #
#                          nwm\桌面\ZStack-CC2530-2.2.0-1.3.0\ZStack-CC2530-2 #
#                          .2.0-1.3.0\Projects\zstack\Samples\MyfirstAPP\CC25 #
#                          30DB\..\..\..\..\..\COMPONENTS\HAL\TARGET\CC2530EB #
#                          \" -I "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC #
#                          2530-2.2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Project #
#                          s\zstack\Samples\MyfirstAPP\CC2530DB\..\..\..\..\. #
#                          .\COMPONENTS\OSAL\MCU\CCSOC\" -I                   #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\..\..\..\..\..\COMP #
#                          ONENTS\OSAL\INCLUDE\" -I                           #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\..\..\..\..\..\COMP #
#                          ONENTS\STACK\AF\" -I "D:\个人重要资料(勿删)\yuanwm #
#                          \桌面\ZStack-CC2530-2.2.0-1.3.0\ZStack-CC2530-2.2. #
#                          0-1.3.0\Projects\zstack\Samples\MyfirstAPP\CC2530D #
#                          B\..\..\..\..\..\COMPONENTS\STACK\NWK\" -I         #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\..\..\..\..\..\COMP #
#                          ONENTS\STACK\SEC\" -I "D:\个人重要资料(勿删)\yuanw #
#                          m\桌面\ZStack-CC2530-2.2.0-1.3.0\ZStack-CC2530-2.2 #
#                          .0-1.3.0\Projects\zstack\Samples\MyfirstAPP\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\STACK\SAPI\" -I       #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\..\..\..\..\..\COMP #
#                          ONENTS\STACK\SYS\" -I "D:\个人重要资料(勿删)\yuanw #
#                          m\桌面\ZStack-CC2530-2.2.0-1.3.0\ZStack-CC2530-2.2 #
#                          .0-1.3.0\Projects\zstack\Samples\MyfirstAPP\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\STACK\ZDO\" -I        #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\..\..\..\..\..\COMP #
#                          ONENTS\ZMAC\F8W\" -I "D:\个人重要资料(勿删)\yuanwm #
#                          \桌面\ZStack-CC2530-2.2.0-1.3.0\ZStack-CC2530-2.2. #
#                          0-1.3.0\Projects\zstack\Samples\MyfirstAPP\CC2530D #
#                          B\..\..\..\..\..\COMPONENTS\ZMAC\" -I              #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\..\..\..\..\..\COMP #
#                          ONENTS\SERVICES\SADDR\" -I                         #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\..\..\..\..\..\COMP #
#                          ONENTS\SERVICES\SDATA\" -I                         #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\..\..\..\..\..\COMP #
#                          ONENTS\MAC\INCLUDE\" -I "D:\个人重要资料(勿删)\yua #
#                          nwm\桌面\ZStack-CC2530-2.2.0-1.3.0\ZStack-CC2530-2 #
#                          .2.0-1.3.0\Projects\zstack\Samples\MyfirstAPP\CC25 #
#                          30DB\..\..\..\..\..\COMPONENTS\MAC\HIGH_LEVEL\"    #
#                          -I "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC253 #
#                          0-2.2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\z #
#                          stack\Samples\MyfirstAPP\CC2530DB\..\..\..\..\..\C #
#                          OMPONENTS\MAC\LOW_LEVEL\srf04\" -I                 #
#                          "D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2 #
#                          .2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zsta #
#                          ck\Samples\MyfirstAPP\CC2530DB\..\..\..\..\..\COMP #
#                          ONENTS\MAC\LOW_LEVEL\srf04\SINGLE_CHIP\" -I        #
#                          "C:\Program Files\IAR Systems\Embedded Workbench   #
#                          5.3 Evaluation version\8051\INC\" -I "C:\Program   #
#                          Files\IAR Systems\Embedded Workbench 5.3           #
#                          Evaluation version\8051\INC\CLIB\" -Ohz            #
#    List file          =  D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2. #
#                          2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zstac #
#                          k\Samples\MyfirstAPP\CC2530DB\CoordinatorEB\List\Z #
#                          Main.lst                                           #
#    Object file        =  D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2. #
#                          2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zstac #
#                          k\Samples\MyfirstAPP\CC2530DB\CoordinatorEB\Obj\ZM #
#                          ain.r51                                            #
#                                                                             #
#                                                                             #
###############################################################################

D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2.2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zstack\ZMain\TI2530DB\ZMain.c
      1          /**************************************************************************************************
      2            Filename:       ZMain.c
      3            Revised:        $Date: 2009-04-03 12:59:44 -0700 (Fri, 03 Apr 2009) $
      4            Revision:       $Revision: 19677 $
      5          
      6            Description:    Startup and shutdown code for ZStack
      7            Notes:          This version targets the Chipcon CC2530
      8          
      9          
     10            Copyright 2005-2009 Texas Instruments Incorporated. All rights reserved.
     11          
     12            IMPORTANT: Your use of this Software is limited to those specific rights
     13            granted under the terms of a software license agreement between the user
     14            who downloaded the software, his/her employer (which must be your employer)
     15            and Texas Instruments Incorporated (the "License").  You may not use this
     16            Software unless you agree to abide by the terms of the License. The License
     17            limits your use, and you acknowledge, that the Software may not be modified,
     18            copied or distributed unless embedded on a Texas Instruments microcontroller
     19            or used solely and exclusively in conjunction with a Texas Instruments radio
     20            frequency transceiver, which is integrated into your product.  Other than for
     21            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     22            works of, modify, distribute, perform, display or sell this Software and/or
     23            its documentation for any purpose.
     24          
     25            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     26            PROVIDED AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     27            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     28            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     29            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     30            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     31            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     32            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     33            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     34            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     35            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     36          
     37            Should you have any questions regarding your right to use this Software,
     38            contact Texas Instruments Incorporated at www.TI.com.
     39          **************************************************************************************************/
     40          
     41          /*********************************************************************
     42           * INCLUDES
     43           */
     44          
     45          #include "ZComDef.h"
     46          #include "OSAL.h"
     47          #include "OSAL_Nv.h"
     48          #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0x81
   \   unsigned char volatile __sfr SP
   \                     `SP`:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x8f
   \   unsigned char volatile __sfr P0INP
   \                     P0INP:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x9d
   \   unsigned char volatile __sfr SLEEPSTA
   \                     SLEEPSTA:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x9e
   \   unsigned char volatile __sfr CLKCONSTA
   \                     CLKCONSTA:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xbe
   \   unsigned char volatile __sfr SLEEPCMD
   \                     SLEEPCMD:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xc6
   \   unsigned char volatile __sfr CLKCONCMD
   \                     CLKCONCMD:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfd
   \   unsigned char volatile __sfr P0DIR
   \                     P0DIR:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
     49          #include "ZMAC.h"
     50          
     51          #ifndef NONWK
     52            #include "AF.h"
     53          #endif
     54          
     55          /* Hal */
     56          #include "hal_lcd.h"
     57          #include "hal_led.h"
     58          #include "hal_adc.h"
     59          #include "hal_drivers.h"
     60          #include "hal_assert.h"
     61          #include "hal_flash.h"
     62          
     63          /*********************************************************************
     64           * MACROS
     65           */
     66          
     67          /*********************************************************************
     68           * CONSTANTS
     69           */
     70          
     71          // Maximun number of Vdd samples checked before go on
     72          #define MAX_VDD_SAMPLES  3
     73          #define ZMAIN_VDD_LIMIT  HAL_ADC_VDD_LIMIT_4
     74          
     75          /*********************************************************************
     76           * TYPEDEFS
     77           */
     78          
     79          /*********************************************************************
     80           * GLOBAL VARIABLES
     81           */
     82          
     83          /*********************************************************************
     84           * EXTERNAL VARIABLES
     85           */
     86          
     87          /*********************************************************************
     88           * EXTERNAL FUNCTIONS
     89           */
     90          
     91          extern bool HalAdcCheckVdd (uint8 limit);
     92          extern void HalLcdWriteString ( char *str, uint8 option);
     93          extern uint16 HalUARTWrite(uint8 port, uint8 *buf, uint16 len);
     94          
     95          /*********************************************************************
     96           * LOCAL VARIABLES
     97           */
     98          
     99          /*********************************************************************
    100           * LOCAL FUNCTIONS
    101           */
    102          static void zmain_dev_info( void );
    103          static void zmain_ext_addr( void );
    104          static void zmain_ram_init( void );
    105          static void zmain_vdd_check( void );
    106          
    107          #ifdef LCD_SUPPORTED
    108          static void zmain_lcd_init( void );
    109          #endif
    110          
    111          /*********************************************************************
    112           * @fn      main
    113           * @brief   First function called after startup.
    114           * @return  don't care
    115           *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    116          int main( void )
   \                     main:
    117          {
   \   000000                ; Auto size: 0
    118            
    119            
    120            // Turn off interrupts
    121            osal_int_disable( INTS_ALL );
   \   000000                ; Setup parameters for call to function osal_int_disable
   \   000000   79FF         MOV     R1,#-0x1
   \   000002   12....       LCALL   ??osal_int_disable?relay
    122          
    123            // Initialization for board related stuff such as LEDs
    124            HAL_BOARD_INIT();
   \   000005   53BEFB       ANL     0xbe,#0xfb
   \                     ??main_0:
   \   000008   E59D         MOV     A,0x9d
   \   00000A   A2E6         MOV     C,0xE0 /* A   */.6
   \   00000C   50FA         JNC     ??main_0
   \   00000E   00           NOP
   \   00000F   78F8         MOV     R0,#-0x8
   \   000011   7901         MOV     R1,#0x1
   \                     ??main_1:
   \   000013   00           NOP
   \   000014   E8           MOV     A,R0
   \   000015   24FF         ADD     A,#-0x1
   \   000017   18           DEC     R0
   \   000018   E9           MOV     A,R1
   \   000019   34FF         ADDC    A,#-0x1
   \   00001B   F9           MOV     R1,A
   \   00001C   E8           MOV     A,R0
   \   00001D   7001         JNZ     ??main_2
   \   00001F   E9           MOV     A,R1
   \                     ??main_2:
   \   000020   70F1         JNZ     ??main_1
   \   000022   75C600       MOV     0xc6,#0x0
   \                     ??main_3:
   \   000025   E59E         MOV     A,0x9e
   \   000027   70FC         JNZ     ??main_3
   \   000029   43BE04       ORL     0xbe,#0x4
   \   00002C   43FE01       ORL     0xfe,#0x1
   \   00002F   43FD80       ORL     0xfd,#0x80
   \   000032   438F04       ORL     0x8f,#0x4
    125                                           
    126            // Make sure supply voltage is high enough to run
    127            zmain_vdd_check();
   \   000035                ; Setup parameters for call to function zmain_vdd_check
   \   000035   12....       LCALL   ??zmain_vdd_check?relay
    128          
    129            // Initialize stack memory
    130            zmain_ram_init();
   \   000038   78..         MOV     R0,#(SFB(XSP) & 0xff)
   \   00003A   8682         MOV     DPL,@R0
   \   00003C   08           INC     R0
   \   00003D   8683         MOV     DPH,@R0
   \   00003F   8003         SJMP    ??main_4
   \                     ??main_5:
   \   000041   74CD         MOV     A,#-0x33
   \   000043   F0           MOVX    @DPTR,A
   \                     ??main_4:
   \   000044   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_2:
   \   000047   C3           CLR     C
   \   000048   74..         MOV     A,#(SFB(XSTACK) & 0xff)
   \   00004A   9582         SUBB    A,DPL
   \   00004C   74..         MOV     A,#((SFB(XSTACK) >> 8) & 0xff)
   \   00004E   9583         SUBB    A,DPH
   \   000050   40EF         JC      ??main_5
   \   000052   7582..       MOV     DPL,#((SFE(ISTACK) + 255) & 0xff)
   \   000055   7583..       MOV     DPH,#(((SFE(ISTACK) - 1) >> 8) & 0xff)
   \   000058   8004         SJMP    ??main_6
   \                     ??main_7:
   \   00005A   A882         MOV     R0,DPL
   \   00005C   76CD         MOV     @R0,#-0x33
   \                     ??main_6:
   \   00005E   E581         MOV     A,0x81
   \   000060   F5..         MOV     ?V0 + 0,A
   \   000062   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_3:
   \   000065   75..00       MOV     ?V0 + 1,#0x0
   \   000068   C3           CLR     C
   \   000069   E5..         MOV     A,?V0 + 0
   \   00006B   9582         SUBB    A,DPL
   \   00006D   E4           CLR     A
   \   00006E   9583         SUBB    A,DPH
   \   000070   40E8         JC      ??main_7
    131          
    132            //Initialize board I/O
    133            InitBoard( OB_COLD );
   \   000072                ; Setup parameters for call to function InitBoard
   \   000072   7900         MOV     R1,#0x0
   \   000074   12....       LCALL   ??InitBoard?relay
    134          
    135            // Initialze HAL drivers
    136            HalDriverInit();
   \   000077                ; Setup parameters for call to function HalDriverInit
   \   000077   12....       LCALL   ??HalDriverInit?relay
    137          
    138            // Initialize NV System
    139            osal_nv_init( NULL );
   \   00007A                ; Setup parameters for call to function osal_nv_init
   \   00007A   7A00         MOV     R2,#0x0
   \   00007C   7B00         MOV     R3,#0x0
   \   00007E   12....       LCALL   ??osal_nv_init?relay
    140          
    141            // Initialize basic NV items
    142            zgInit();
   \   000081                ; Setup parameters for call to function zgInit
   \   000081   12....       LCALL   ??zgInit?relay
    143          
    144            // Initialize the MAC
    145            ZMacInit();
   \   000084                ; Setup parameters for call to function ZMacInit
   \   000084   12....       LCALL   ??ZMacInit?relay
    146          
    147            // Determine the extended address
    148            zmain_ext_addr();
   \   000087                ; Setup parameters for call to function zmain_ext_addr
   \   000087   12....       LCALL   ??zmain_ext_addr?relay
    149          
    150          #ifndef NONWK
    151            // Since the AF isn't a task, call it's initialization routine
    152            afInit();
   \   00008A                ; Setup parameters for call to function afInit
   \   00008A   12....       LCALL   ??afInit?relay
    153          #endif
    154          
    155            // Initialize the operating system
    156            osal_init_system();
   \   00008D                ; Setup parameters for call to function osal_init_system
   \   00008D   12....       LCALL   ??osal_init_system?relay
    157          
    158            // Allow interrupts
    159            osal_int_enable( INTS_ALL );
   \   000090                ; Setup parameters for call to function osal_int_enable
   \   000090   79FF         MOV     R1,#-0x1
   \   000092   12....       LCALL   ??osal_int_enable?relay
    160          
    161            // Final board initialization
    162            InitBoard( OB_READY ); //sd rest
   \   000095                ; Setup parameters for call to function InitBoard
   \   000095   7902         MOV     R1,#0x2
   \   000097   12....       LCALL   ??InitBoard?relay
    163            
    164            // Display information about this device
    165           // zmain_dev_info();
    166          
    167            /* Display the device info on the LCD */
    168          #ifdef LCD_SUPPORTED
    169           // zmain_lcd_init();
    170          #endif
    171          
    172          #ifdef WDT_IN_PM1
    173            /* If WDT is used, this is a good place to enable it. */
    174            WatchDogEnable( WDTIMX );
    175          #endif
    176          
    177            osal_start_system(); // No Return from here
   \   00009A                ; Setup parameters for call to function osal_start_system
   \   00009A   12....       LCALL   ??osal_start_system?relay
    178          
    179            // Shouldn't get here
    180            return ( 0 );
   \   00009D   7A00         MOV     R2,#0x0
   \   00009F   7B00         MOV     R3,#0x0
   \   0000A1   02....       LJMP    ?BRET
   \   0000A4                REQUIRE SLEEPCMD
   \   0000A4                REQUIRE CLKCONCMD
   \   0000A4                REQUIRE P0DIR
   \   0000A4                REQUIRE P1DIR
   \   0000A4                REQUIRE P0INP
   \   0000A4                REQUIRE SLEEPSTA
   \   0000A4                REQUIRE CLKCONSTA
   \   0000A4                REQUIRE `SP`
    181          } // main()
    182          
    183          /*********************************************************************
    184           * @fn      zmain_vdd_check
    185           * @brief   Check if the Vdd is OK to run the processor.
    186           * @return  Return if Vdd is ok; otherwise, flash LED, then reset
    187           *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    188          static void zmain_vdd_check( void )
   \                     zmain_vdd_check:
    189          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    190            uint8 vdd_passed_count = 0;
   \   000005   7E00         MOV     R6,#0x0
    191            bool toggle = 0;
   \   000007   7F00         MOV     R7,#0x0
    192          
    193            // Repeat getting the sample until number of failures or successes hits MAX
    194            // then based on the count value, determine if the device is ready or not
    195            while ( vdd_passed_count < MAX_VDD_SAMPLES )
    196            {
    197              if ( HalAdcCheckVdd (ZMAIN_VDD_LIMIT) )
   \                     ??zmain_vdd_check_0:
   \   000009                ; Setup parameters for call to function HalAdcCheckVdd
   \   000009   7904         MOV     R1,#0x4
   \   00000B   12....       LCALL   ??HalAdcCheckVdd?relay
   \   00000E   E9           MOV     A,R1
   \   00000F   6019         JZ      ??zmain_vdd_check_1
    198              {
    199                vdd_passed_count++;    // Keep track # times Vdd passes in a row
   \   000011   0E           INC     R6
    200                MicroWait (10000);     // Wait 10ms to try again
   \   000012                ; Setup parameters for call to function Onboard_wait
   \   000012   7A10         MOV     R2,#0x10
   \   000014   7B27         MOV     R3,#0x27
   \   000016   12....       LCALL   ??Onboard_wait?relay
    201              }
    202              else
    203              {
    204                vdd_passed_count = 0;  // Reset passed counter
    205                MicroWait (50000);     // Wait 50ms
    206                MicroWait (50000);     // Wait another 50ms to try again
    207              }
    208          
    209              /* toggle LED1 and LED2 */
    210              if (vdd_passed_count == 0)
   \   000019   EE           MOV     A,R6
   \   00001A   601E         JZ      ??zmain_vdd_check_2
   \   00001C   C3           CLR     C
   \   00001D   9403         SUBB    A,#0x3
   \   00001F   40E8         JC      ??zmain_vdd_check_0
    211              {
    212                if ((toggle = !(toggle)))
    213                  HAL_TOGGLE_LED1();
    214                else
    215                  HAL_TOGGLE_LED2();
    216              }
    217            }
    218          
    219            /* turn off LED1 */
    220            HAL_TURN_OFF_LED1();
   \   000021   D290         SETB    0x90.0
    221            HAL_TURN_OFF_LED2();
   \   000023   D291         SETB    0x90.1
    222          }
   \   000025   7F01         MOV     R7,#0x1
   \   000027   02....       LJMP    ?BANKED_LEAVE_XDATA
   \                     ??zmain_vdd_check_1:
   \   00002A   7E00         MOV     R6,#0x0
   \   00002C                ; Setup parameters for call to function Onboard_wait
   \   00002C   7A50         MOV     R2,#0x50
   \   00002E   7BC3         MOV     R3,#-0x3d
   \   000030   12....       LCALL   ??Onboard_wait?relay
   \   000033                ; Setup parameters for call to function Onboard_wait
   \   000033   7A50         MOV     R2,#0x50
   \   000035   7BC3         MOV     R3,#-0x3d
   \   000037   12....       LCALL   ??Onboard_wait?relay
   \                     ??zmain_vdd_check_2:
   \   00003A   EF           MOV     A,R7
   \   00003B   700A         JNZ     ??zmain_vdd_check_3
   \   00003D   7F01         MOV     R7,#0x1
   \   00003F   A290         MOV     C,0x90.0
   \   000041   400E         JC      ??zmain_vdd_check_4
   \   000043   D290         SETB    0x90.0
   \   000045   80C2         SJMP    ??zmain_vdd_check_0
   \                     ??zmain_vdd_check_3:
   \   000047   7F00         MOV     R7,#0x0
   \   000049   A291         MOV     C,0x90.1
   \   00004B   4008         JC      ??zmain_vdd_check_5
   \   00004D   D291         SETB    0x90.1
   \   00004F   80B8         SJMP    ??zmain_vdd_check_0
   \                     ??zmain_vdd_check_4:
   \   000051   C290         CLR     0x90.0
   \   000053   80B4         SJMP    ??zmain_vdd_check_0
   \                     ??zmain_vdd_check_5:
   \   000055   C291         CLR     0x90.1
   \   000057   80B0         SJMP    ??zmain_vdd_check_0
   \   000059                REQUIRE _A_P1
    223          
    224          /**************************************************************************************************
    225           * @fn          zmain_ext_addr
    226           *
    227           * @brief       Execute a prioritized search for a valid extended address and write the results
    228           *              into the OSAL NV system for use by the system.
    229           *
    230           * input parameters
    231           *
    232           * None.
    233           *
    234           * output parameters
    235           *
    236           * None.
    237           *
    238           * @return      None.
    239           **************************************************************************************************
    240           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    241          static void zmain_ext_addr(void)
   \                     zmain_ext_addr:
    242          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 11
   \   000005   74F5         MOV     A,#-0xb
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    243            
    244            uint8 nullAddr[Z_EXTADDR_LEN] = {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF};
   \   00000A   7403         MOV     A,#0x3
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   AC82         MOV     R4,DPL
   \   000011   AD83         MOV     R5,DPH
   \   000013   7583..       MOV     DPH,#((`?<Constant {255, 255, 255, 255, 255, 255, 255,` >> 8) & 0xff)
   \   000016   7582..       MOV     DPL,#(`?<Constant {255, 255, 255, 255, 255, 255, 255,` & 0xff)
   \   000019   7408         MOV     A,#0x8
   \   00001B   12....       LCALL   ?MOVE_LONG8_XDATA_XDATA
    245            uint8 writeNV = TRUE;
    246            
    247            
    248           //  uint8 nv_data=12;
    249            // uint8 nv_origin_data = 0x55;
    250            
    251              osal_nv_item_init(ZCD_NV_APP_TEST1,1,NULL);
   \   00001E                ; Setup parameters for call to function osal_nv_item_init
   \   00001E   F5..         MOV     ?V0 + 0,A
   \   000020   F5..         MOV     ?V0 + 1,A
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000027   7C01         MOV     R4,#0x1
   \   000029   7D00         MOV     R5,#0x0
   \   00002B   7A04         MOV     R2,#0x4
   \   00002D   7B02         MOV     R3,#0x2
   \   00002F   12....       LCALL   ??osal_nv_item_init?relay
   \   000032   7402         MOV     A,#0x2
   \   000034   12....       LCALL   ?DEALLOC_XSTACK8
    252             // osal_nv_write(ZCD_NV_APP_TEST1,0,1,&nv_origin_data);
    253          
    254              
    255              
    256            // First check whether a non-erased extended address exists in the OSAL NV.
    257            if ((SUCCESS != osal_nv_item_init(ZCD_NV_EXTADDR, Z_EXTADDR_LEN, NULL))  ||
    258                (SUCCESS != osal_nv_read(ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, aExtendedAddress)) ||
    259                (osal_memcmp(aExtendedAddress, nullAddr, Z_EXTADDR_LEN)))
   \   000037   85..82       MOV     DPL,?XSP + 0
   \   00003A   85..83       MOV     DPH,?XSP + 1
   \   00003D   74..         MOV     A,#(aExtendedAddress & 0xff)
   \   00003F   F0           MOVX    @DPTR,A
   \   000040   A3           INC     DPTR
   \   000041   74..         MOV     A,#((aExtendedAddress >> 8) & 0xff)
   \   000043   F0           MOVX    @DPTR,A
   \   000044   A3           INC     DPTR
   \   000045   E4           CLR     A
   \   000046   F0           MOVX    @DPTR,A
   \   000047   7403         MOV     A,#0x3
   \   000049   12....       LCALL   ?XSTACK_DISP0_8
   \   00004C   A982         MOV     R1,DPL
   \   00004E   AA83         MOV     R2,DPH
   \   000050   89..         MOV     ?V0 + 0,R1
   \   000052   8A..         MOV     ?V0 + 1,R2
   \   000054   75..00       MOV     ?V0 + 2,#0x0
   \   000057                ; Setup parameters for call to function osal_nv_item_init
   \   000057   75..00       MOV     ?V0 + 4,#0x0
   \   00005A   75..00       MOV     ?V0 + 5,#0x0
   \   00005D   78..         MOV     R0,#?V0 + 4
   \   00005F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000062   7C08         MOV     R4,#0x8
   \   000064   7D00         MOV     R5,#0x0
   \   000066   7A01         MOV     R2,#0x1
   \   000068   7B00         MOV     R3,#0x0
   \   00006A   12....       LCALL   ??osal_nv_item_init?relay
   \   00006D   7402         MOV     A,#0x2
   \   00006F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000072   E9           MOV     A,R1
   \   000073   7043         JNZ     ??zmain_ext_addr_0
   \   000075                ; Setup parameters for call to function osal_nv_read
   \   000075   75....       MOV     ?V0 + 4,#(aExtendedAddress & 0xff)
   \   000078   75....       MOV     ?V0 + 5,#((aExtendedAddress >> 8) & 0xff)
   \   00007B   78..         MOV     R0,#?V0 + 4
   \   00007D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000080   75..08       MOV     ?V0 + 4,#0x8
   \   000083   75..00       MOV     ?V0 + 5,#0x0
   \   000086   78..         MOV     R0,#?V0 + 4
   \   000088   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008B   7C00         MOV     R4,#0x0
   \   00008D   7D00         MOV     R5,#0x0
   \   00008F   7A01         MOV     R2,#0x1
   \   000091   7B00         MOV     R3,#0x0
   \   000093   12....       LCALL   ??osal_nv_read?relay
   \   000096   7404         MOV     A,#0x4
   \   000098   12....       LCALL   ?DEALLOC_XSTACK8
   \   00009B   E9           MOV     A,R1
   \   00009C   701A         JNZ     ??zmain_ext_addr_0
   \   00009E                ; Setup parameters for call to function osal_memcmp
   \   00009E   78..         MOV     R0,#?V0 + 0
   \   0000A0   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000A3   7C08         MOV     R4,#0x8
   \   0000A5   7D00         MOV     R5,#0x0
   \   0000A7   7403         MOV     A,#0x3
   \   0000A9   12....       LCALL   ?XSTACK_DISP0_8
   \   0000AC   12....       LCALL   ?Subroutine1 & 0xFFFF
   \                     ??CrossCallReturnLabel_0:
   \   0000AF   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000B2   E9           MOV     A,R1
   \   0000B3   7003         JNZ     $+5
   \   0000B5   02....       LJMP    ??zmain_ext_addr_1 & 0xFFFF
    260            {
    261              // Attempt to read the extended address from the location on the lock bits page
    262              // where the programming tools know to reserve it.
    263              HalFlashRead(HAL_FLASH_IEEE_PAGE, HAL_FLASH_IEEE_OSET, aExtendedAddress, Z_EXTADDR_LEN);
   \                     ??zmain_ext_addr_0:
   \   0000B8                ; Setup parameters for call to function HalFlashRead
   \   0000B8   75..08       MOV     ?V0 + 4,#0x8
   \   0000BB   78..         MOV     R0,#?V0 + 4
   \   0000BD   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000C0   7C..         MOV     R4,#(aExtendedAddress & 0xff)
   \   0000C2   7D..         MOV     R5,#((aExtendedAddress >> 8) & 0xff)
   \   0000C4   7AE8         MOV     R2,#-0x18
   \   0000C6   7B07         MOV     R3,#0x7
   \   0000C8   797F         MOV     R1,#0x7f
   \   0000CA   12....       LCALL   ??HalFlashRead?relay
   \   0000CD   7402         MOV     A,#0x2
   \   0000CF   12....       LCALL   ?DEALLOC_XSTACK8
    264          
    265              if (osal_memcmp(aExtendedAddress, nullAddr, Z_EXTADDR_LEN))
   \   0000D2                ; Setup parameters for call to function osal_memcmp
   \   0000D2   78..         MOV     R0,#?V0 + 0
   \   0000D4   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000D7   7C08         MOV     R4,#0x8
   \   0000D9   7D00         MOV     R5,#0x0
   \   0000DB   7403         MOV     A,#0x3
   \   0000DD   12....       LCALL   ?XSTACK_DISP0_8
   \   0000E0   12....       LCALL   ?Subroutine1 & 0xFFFF
   \                     ??CrossCallReturnLabel_1:
   \   0000E3   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000E6   E9           MOV     A,R1
   \   0000E7   6035         JZ      ??zmain_ext_addr_2
    266              {
    267                // Attempt to read the extended address from the designated location in the Info Page.
    268                if (!osal_memcmp((uint8 *)(P_INFOPAGE+HAL_INFOP_IEEE_OSET), nullAddr, Z_EXTADDR_LEN))
   \   0000E9                ; Setup parameters for call to function osal_memcmp
   \   0000E9   78..         MOV     R0,#?V0 + 0
   \   0000EB   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000EE   7C08         MOV     R4,#0x8
   \   0000F0   7D00         MOV     R5,#0x0
   \   0000F2   790C         MOV     R1,#0xc
   \   0000F4   7A78         MOV     R2,#0x78
   \   0000F6   7B00         MOV     R3,#0x0
   \   0000F8   12....       LCALL   ??osal_memcmp?relay
   \   0000FB   7403         MOV     A,#0x3
   \   0000FD   12....       LCALL   ?DEALLOC_XSTACK8
   \   000100   E9           MOV     A,R1
   \   000101   7054         JNZ     ??zmain_ext_addr_3
    269                {
    270                  osal_memcpy(aExtendedAddress, (uint8 *)(P_INFOPAGE+HAL_INFOP_IEEE_OSET), Z_EXTADDR_LEN);
   \   000103                ; Setup parameters for call to function osal_memcpy
   \   000103   75..0C       MOV     ?V0 + 0,#0xc
   \   000106   75..78       MOV     ?V0 + 1,#0x78
   \   000109   78..         MOV     R0,#?V0 + 0
   \   00010B   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00010E   7C08         MOV     R4,#0x8
   \   000110   7D00         MOV     R5,#0x0
   \   000112   7A..         MOV     R2,#(aExtendedAddress & 0xff)
   \   000114   7B..         MOV     R3,#((aExtendedAddress >> 8) & 0xff)
   \   000116   12....       LCALL   ??osal_memcpy?relay
   \   000119   7403         MOV     A,#0x3
   \   00011B   12....       LCALL   ?DEALLOC_XSTACK8
    271                }
    272                else  // No valid extended address was found.
    273                {
    274                  uint8 idx;
    275                  
    276          #if !defined ( NV_RESTORE )
    277                  writeNV = FALSE;  // Make this a temporary IEEE address
    278          #endif
    279          
    280                  /* Attempt to create a sufficiently random extended address for expediency.
    281                   * Note: this is only valid/legal in a test environment and
    282                   *       must never be used for a commercial product.
    283                   */
    284                  for (idx = 0; idx < (Z_EXTADDR_LEN - 2);)
    285                  {
    286                    uint16 randy = osal_rand();
    287                    aExtendedAddress[idx++] = LO_UINT16(randy);
    288                    aExtendedAddress[idx++] = HI_UINT16(randy);
    289                  }
    290                  // Next-to-MSB identifies ZigBee devicetype.
    291          #if   defined ZDO_COORDINATOR
    292                  aExtendedAddress[idx++] = 0x10;
    293          #elif defined RTR_NWK
    294                  aExtendedAddress[idx++] = 0x20;
    295          #else
    296                  aExtendedAddress[idx++] = 0x30;
    297          #endif
    298                  // MSB has historical signficance.
    299                  aExtendedAddress[idx] = 0xF8;
    300                }
    301              }
    302          
    303              if ( writeNV )
    304              {
    305                (void)osal_nv_write(ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, aExtendedAddress);
   \                     ??zmain_ext_addr_2:
   \   00011E                ; Setup parameters for call to function osal_nv_write
   \   00011E   75....       MOV     ?V0 + 0,#(aExtendedAddress & 0xff)
   \   000121   75....       MOV     ?V0 + 1,#((aExtendedAddress >> 8) & 0xff)
   \   000124   78..         MOV     R0,#?V0 + 0
   \   000126   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000129   75..08       MOV     ?V0 + 0,#0x8
   \   00012C   75..00       MOV     ?V0 + 1,#0x0
   \   00012F   78..         MOV     R0,#?V0 + 0
   \   000131   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000134   7C00         MOV     R4,#0x0
   \   000136   7D00         MOV     R5,#0x0
   \   000138   7A01         MOV     R2,#0x1
   \   00013A   7B00         MOV     R3,#0x0
   \   00013C   12....       LCALL   ??osal_nv_write?relay
   \   00013F   7404         MOV     A,#0x4
   \   000141   12....       LCALL   ?DEALLOC_XSTACK8
    306              }
    307            }
    308          
    309            // Set the MAC PIB extended address according to results from above.
    310            (void)ZMacSetReq(MAC_EXTENDED_ADDRESS, aExtendedAddress);
   \                     ??zmain_ext_addr_1:
   \   000144                ; Setup parameters for call to function ZMacSetReq
   \   000144   7A..         MOV     R2,#(aExtendedAddress & 0xff)
   \   000146   7B..         MOV     R3,#((aExtendedAddress >> 8) & 0xff)
   \   000148   79E2         MOV     R1,#-0x1e
   \   00014A   12....       LCALL   ??ZMacSetReq?relay
    311          }
   \   00014D   740B         MOV     A,#0xb
   \   00014F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000152   7F06         MOV     R7,#0x6
   \   000154   02....       LJMP    ?BANKED_LEAVE_XDATA
   \                     ??zmain_ext_addr_3:
   \   000157   7E00         MOV     R6,#0x0
   \                     ??zmain_ext_addr_4:
   \   000159                ; Setup parameters for call to function osal_rand
   \   000159   12....       LCALL   ??osal_rand?relay
   \   00015C   8A..         MOV     ?V0 + 0,R2
   \   00015E   A8..         MOV     R0,?V0 + 0
   \   000160   8E..         MOV     ?V0 + 0,R6
   \   000162   E5..         MOV     A,?V0 + 0
   \   000164   12....       LCALL   ??Subroutine3_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_4:
   \   000167   E8           MOV     A,R0
   \   000168   F0           MOVX    @DPTR,A
   \   000169   0E           INC     R6
   \   00016A   12....       LCALL   ?Subroutine0 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   00016D   EB           MOV     A,R3
   \   00016E   F0           MOVX    @DPTR,A
   \   00016F   0E           INC     R6
   \   000170   EE           MOV     A,R6
   \   000171   C3           CLR     C
   \   000172   9406         SUBB    A,#0x6
   \   000174   40E3         JC      ??zmain_ext_addr_4
   \   000176   12....       LCALL   ?Subroutine0 & 0xFFFF
   \                     ??CrossCallReturnLabel_7:
   \   000179   7410         MOV     A,#0x10
   \   00017B   F0           MOVX    @DPTR,A
   \   00017C   7401         MOV     A,#0x1
   \   00017E   2E           ADD     A,R6
   \   00017F   12....       LCALL   ??Subroutine3_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   000182   74F8         MOV     A,#-0x8
   \   000184   F0           MOVX    @DPTR,A
   \   000185   80BD         SJMP    ??zmain_ext_addr_1

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F9           MOV     R1,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FA           MOV     R2,A
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   FB           MOV     R3,A
   \   000008   12....       LCALL   ??osal_memcmp?relay
   \   00000B   7403         MOV     A,#0x3
   \   00000D   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   EE           MOV     A,R6
   \   000001                REQUIRE ??Subroutine3_0
   \   000001                ; // Fall through to label ??Subroutine3_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine3_0:
   \   000000   24..         ADD     A,#(aExtendedAddress & 0xff)
   \   000002   F582         MOV     DPL,A
   \   000004   E4           CLR     A
   \   000005   34..         ADDC    A,#((aExtendedAddress >> 8) & 0xff)
   \   000007   F583         MOV     DPH,A
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   E582         MOV     A,DPL
   \   000002   24FF         ADD     A,#-0x1
   \   000004   F582         MOV     DPL,A
   \   000006   E583         MOV     A,DPH
   \   000008   34FF         ADDC    A,#-0x1
   \   00000A   F583         MOV     DPH,A
   \   00000C   22           RET

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??main?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    main

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zmain_vdd_check?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zmain_vdd_check

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zmain_ext_addr?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zmain_ext_addr

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant {255, 255, 255, 255, 255, 255, 255,`:
   \   000000   FFFFFFFF     DB 255, 255, 255, 255, 255, 255, 255, 255
   \            FFFFFFFF
    312          
    313          /**************************************************************************************************
    314           * @fn          zmain_dev_info
    315           *
    316           * @brief       This displays the IEEE (MSB to LSB) on the LCD.
    317           *
    318           * input parameters
    319           *
    320           * None.
    321           *
    322           * output parameters
    323           *
    324           * None.
    325           *
    326           * @return      None.
    327           **************************************************************************************************
    328           */
    329          static void zmain_dev_info(void)
    330          {
    331          #ifdef LCD_SUPPORTED
    332            uint8 i;
    333            uint8 *xad;
    334            uint8 lcd_buf[Z_EXTADDR_LEN*2+1];
                         ^
Warning[Pe550]: variable "lcd_buf" was set but never used

  static void zmain_dev_info(void)
              ^
"D:\个人重要资料(勿删)\yuanwm\桌面\ZStack-CC2530-2.2.0-1.3.0\ZStack-CC2530-2.2.0-1.3.0\Projects\zstack\ZMain\TI2530DB\ZMain.c",329  Warning[Pe177]: 
          function "zmain_dev_info" was declared but never referenced
    335           // extern void upLcd( char *ptr,uint8 op );
    336            // Display the extended address.
    337            xad = aExtendedAddress + Z_EXTADDR_LEN - 1;
    338          
    339            for (i = 0; i < Z_EXTADDR_LEN*2; xad--)
    340            {
    341              uint8 ch;
    342              ch = (*xad >> 4) & 0x0F;
    343              lcd_buf[i++] = ch + (( ch < 10 ) ? '0' : '7');
    344              ch = *xad & 0x0F;
    345              lcd_buf[i++] = ch + (( ch < 10 ) ? '0' : '7');
    346            }
    347            lcd_buf[Z_EXTADDR_LEN*2] = '\0';
    348            //HalLcdWriteString( "IEEE: ",  HAL_LCD_LINE_2);
    349            //HalLcdWriteString( (char*)lcd_buf, HAL_LCD_LINE_3 );
    350          #endif
    351          }
    352          
    353          /*********************************************************************
    354           * @fn      zmain_ram_init
    355           * @brief   Initialize ram for stack "high-water-mark" observations.
    356           * @return  none
    357           *********************************************************************/
    358          static void zmain_ram_init( void )
    359          {
    360            uint8 *end;
    361            uint8 *ptr;
    362          
    363            // Initialize the call (parameter) stack
    364            end = (uint8*)CSTK_BEG;  // Lower end
    365            ptr = (uint8*)(*( __idata uint16*)(CSTK_PTR));  // Upper end
    366            while ( --ptr > end )
    367              *ptr = STACK_INIT_VALUE;
    368          
    369            // Initialize the return (address) stack
    370            ptr = (uint8*)RSTK_END - 1;  // Upper end
    371            while ( --ptr > (uint8*)SP )
    372              *(__idata uint8*)ptr = STACK_INIT_VALUE;
    373          }
    374          
    375          #ifdef LCD_SUPPORTED
    376          /*********************************************************************
    377           * @fn      zmain_lcd_init
    378           * @brief   Initialize LCD at start up.
    379           * @return  none
    380           *********************************************************************/
    381          static void zmain_lcd_init ( void )
                             ^
Warning[Pe177]: function "zmain_lcd_init" was declared but never referenced
    382          {
    383          #ifdef SERIAL_DEBUG_SUPPORTED
    384            {
    385              HalLcdWriteString( "TexasInstruments", HAL_LCD_LINE_1 );
    386          
    387          #if defined( MT_MAC_FUNC )
    388          #if defined( ZDO_COORDINATOR )
    389                HalLcdWriteString( "MAC-MT Coord", HAL_LCD_LINE_2 );
    390          #else
    391                HalLcdWriteString( "MAC-MT Device", HAL_LCD_LINE_2 );
    392          #endif // ZDO
    393          #elif defined( MT_NWK_FUNC )
    394          #if defined( ZDO_COORDINATOR )
    395                HalLcdWriteString( "NWK Coordinator", HAL_LCD_LINE_2 );
    396          #else
    397                HalLcdWriteString( "NWK Device", HAL_LCD_LINE_2 );
    398          #endif // ZDO
    399          #endif // MT_FUNC
    400            }
    401          #endif // SERIAL_DEBUG_SUPPORTED
    402          }
    403          #endif
    404          
    405          /*********************************************************************
    406          *********************************************************************/

   Maximum stack usage in bytes:

     Function               ISTACK PSTACK XSTACK
     --------               ------ ------ ------
     main                       1      0      0
       -> osal_int_disable      0      0      0
       -> zmain_vdd_check       0      0      0
       -> InitBoard             0      0      0
       -> HalDriverInit         0      0      0
       -> osal_nv_init          0      0      0
       -> zgInit                0      0      0
       -> ZMacInit              0      0      0
       -> zmain_ext_addr        0      0      0
       -> afInit                0      0      0
       -> osal_init_system      0      0      0
       -> osal_int_enable       0      0      0
       -> InitBoard             0      0      0
       -> osal_start_system     0      0      0
     zmain_ext_addr             2      0     29
       -> osal_nv_item_init     0      0     54
       -> osal_nv_item_init     0      0     54
       -> osal_nv_read          0      0     58
       -> osal_memcmp           0      0     56
       -> HalFlashRead          0      0     54
       -> osal_memcmp           0      0     56
       -> osal_memcmp           0      0     56
       -> osal_memcpy           0      0     56
       -> osal_nv_write         0      0     58
       -> ZMacSetReq            0      0     50
       -> osal_rand             0      0     50
     zmain_vdd_check            0      0      9
       -> HalAdcCheckVdd        0      0     18
       -> Onboard_wait          0      0     18
       -> Onboard_wait          0      0     18
       -> Onboard_wait          0      0     18


   Segment part sizes:

     Function/Label                                 Bytes
     --------------                                 -----
     SP                                                1
     P0INP                                             1
     _A_P1                                             1
     SLEEPSTA                                          1
     CLKCONSTA                                         1
     SLEEPCMD                                          1
     CLKCONCMD                                         1
     P0DIR                                             1
     P1DIR                                             1
     main                                            164
     zmain_vdd_check                                  89
     zmain_ext_addr                                  391
     ?Subroutine1                                     14
     ?Subroutine0                                      1
     ??Subroutine3_0                                  10
     ?Subroutine2                                     13
     ??main?relay                                      6
     ??zmain_vdd_check?relay                           6
     ??zmain_ext_addr?relay                            6
     ?<Constant {255, 255, 255, 255, 255, 255, 255,    8

 
 682 bytes in segment BANKED_CODE
  18 bytes in segment BANK_RELAYS
   9 bytes in segment SFR_AN
   8 bytes in segment XDATA_ROM_C
 
 700 bytes of CODE  memory
   8 bytes of CONST memory
   0 bytes of DATA  memory (+ 9 bytes shared)

Errors: none
Warnings: 3
